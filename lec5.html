<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lecture 5: Stacks, Queues & Hash Tables</title>

  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    :root{
      /* --- THEME CONFIGURATION --- */
      --stage-0: #0b1220;      /* Dark background outer */
      --stage-1: #0f1a2e;      /* Dark background inner */

      --slide-bg: #ffffff;     /* Slide background */
      --ink: #0f172a;          /* Text color */
      --muted: #475569;        /* Subtext color */

      --soft: #e2e8f0;         /* Borders */
      --soft2: #f1f5f9;        /* Light backgrounds */

      --accent: #16a34a;       /* Primary Accent (Green) */
      --accent-2: #22c55e;     /* Brighter Accent */
      
      --radius: 20px;
      --shadow: 0 25px 60px rgba(0,0,0,.45);

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
      --sans: "Segoe UI", system-ui, -apple-system, Roboto, Helvetica, Arial, sans-serif;

      --baseW: 1600;
      --baseH: 900;
      --scale: 1;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      font-family: var(--sans);
      background:
        radial-gradient(1400px 800px at 20% 10%, rgba(34,197,94,.15), transparent 60%),
        radial-gradient(1200px 800px at 85% 20%, rgba(22,163,74,.10), transparent 55%),
        linear-gradient(180deg, var(--stage-0), var(--stage-1));
      color:#e5e7eb;
      overflow:hidden;
    }

    /* Progress Bar */
    #progress-container{
      position:fixed; top:0; left:0; width:100%; height:8px;
      background: rgba(255,255,255,.10); z-index:9999; backdrop-filter: blur(6px);
    }
    #progress-bar{
      height:100%; width:0%;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      transition: width .25s ease;
    }

    /* Stage & Deck */
    .stage{
      position:fixed; inset:0; display:flex; align-items:center; justify-content:center; padding: 18px;
    }
    .deck-wrap{
      width: calc(var(--baseW) * 1px);
      height: calc(var(--baseH) * 1px);
      transform: scale(var(--scale));
      transform-origin:center center;
      position:relative;
    }
    .deck{ width:100%; height:100%; position:relative; }

    /* Slide Logic */
    .slide{
      width:100%; height:100%;
      background: var(--slide-bg);
      color: var(--ink);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      position:absolute; inset:0;
      display:none;
      overflow:hidden;
      padding: 50px 60px;
      animation: slideIn .28s ease;
    }
    .slide.active{ display:block; }
    
    @keyframes slideIn{
      from{ opacity:0; transform: translateY(14px) scale(.99); }
      to{ opacity:1; transform: translateY(0) scale(1); }
    }

    /* Decorative Triangles */
    .slide::before, .slide::after{
      content:""; position:absolute; width: 240px; height: 240px; pointer-events:none; opacity:.95; z-index: 0;
    }
    .slide::before{
      top:-1px; left:-1px;
      background: radial-gradient(circle at 0% 0%, rgba(34,197,94,.22), transparent 55%),
                  linear-gradient(135deg, rgba(22,163,74,.95), rgba(34,197,94,.55));
      clip-path: polygon(0 0, 100% 0, 0 100%);
    }
    .slide::after{
      bottom:-1px; right:-1px;
      background: radial-gradient(circle at 100% 100%, rgba(34,197,94,.22), transparent 55%),
                  linear-gradient(315deg, rgba(22,163,74,.95), rgba(34,197,94,.55));
      clip-path: polygon(100% 100%, 100% 0, 0 100%);
    }

    /* Typography & Header */
    .slide-top{
      position:relative; z-index:2; display:flex; align-items:center; justify-content:space-between; gap:20px; margin-bottom: 22px;
    }
    .meta{ display:flex; flex-direction:column; gap:4px; line-height:1.15; }
    .meta .course{ font-weight:800; letter-spacing:.06em; text-transform:uppercase; color: var(--ink); font-size: 16px; }
    .meta .sub{ font-size: 15px; color: var(--muted); }
    
    h1{ font-size: 56px; margin: 8px 0 10px; letter-spacing:-1.1px; line-height:1.06; position:relative; z-index:2; }
    h2{ font-size: 40px; margin: 6px 0 18px; letter-spacing:-0.8px; position:relative; z-index:2; border-bottom: 3px solid var(--accent); padding-bottom:10px; display:inline-block; }
    h3{ font-size: 26px; margin: 14px 0 10px; color: #0b2a14; position:relative; z-index:2; }
    p, li{ font-size: 20px; line-height:1.6; color: var(--ink); position:relative; z-index:2; }
    
    .muted{ color: var(--muted); }
    code{ font-family: var(--mono); font-size: .92em; background: #f3f4f6; padding: 2px 6px; border-radius: 8px; border: 1px solid #e5e7eb; color: var(--accent); font-weight: bold; }

    /* Layout Utilities */
    .grid-2{ display:grid; grid-template-columns: 1.25fr 1fr; gap: 26px; align-items:start; position:relative; z-index:2; }
    .grid-3{ display:grid; grid-template-columns: repeat(3, 1fr); gap: 14px; align-items:start; position:relative; z-index:2; }
    
    /* Components */
    .card{ background: var(--soft2); border: 1px solid var(--soft); border-radius: 18px; padding: 18px; position:relative; z-index:2; }
    .info-card{ background: #ffffff; border: 1px solid var(--soft); border-left: 6px solid var(--accent); border-radius: 16px; padding: 16px; transition: transform .15s ease, box-shadow .15s ease; cursor: default; }
    .info-card:hover{ transform: translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,.10); }

    .pill{ display:inline-block; border:1px solid var(--soft); background: var(--soft2); border-radius: 999px; padding: 6px 14px; font-size: 14px; color: var(--muted); font-family: var(--mono); white-space:nowrap; }
    .callout{ border-left: 6px solid var(--accent); padding: 18px 22px; background: #f6fffa; border-radius: 16px; margin-top: 14px; position:relative; z-index:2; }
    
    /* Footer */
    .slide-footer{ position:absolute; left: 60px; right: 60px; bottom: 26px; display:flex; align-items:center; justify-content:space-between; color: var(--muted); font-size: 14px; z-index:2; }
    .slide-no{ font-family: var(--mono); background: var(--soft2); border: 1px solid var(--soft); padding: 6px 12px; border-radius: 999px; color: var(--muted); }

    /* Controls (Floating Buttons) */
    .controls{ position:fixed; right: 18px; bottom: 18px; z-index:10000; display:flex; gap: 10px; align-items:center; }
    .iconbtn{ width: 44px; height: 44px; border-radius: 999px; border: 1px solid rgba(255,255,255,.22); background: rgba(15,23,42,.45); color:#e5e7eb; display:grid; place-items:center; cursor:pointer; backdrop-filter: blur(10px); transition: transform .12s ease, background .12s ease; user-select:none; }
    .iconbtn:hover{ transform: translateY(-2px); background: rgba(15,23,42,.65); }
    .iconbtn:disabled{ opacity:.45; cursor:not-allowed; transform:none; }
    .iconbtn svg{ width: 20px; height: 20px; fill: none; stroke: currentColor; stroke-width: 2.4; stroke-linecap: round; stroke-linejoin: round; }

    /* Interactive UI Helpers */
    .mini-btn{ background:#0f1a2e; color:#e5e7eb; border:1px solid rgba(255,255,255,.18); padding: 8px 14px; border-radius: 12px; cursor:pointer; font-weight:900; font-size: 13px; transition: transform .12s ease; user-select:none; }
    .mini-btn:hover{ transform: translateY(-1px); background:#13213a; }
    input[type=text] { padding:8px; border-radius:8px; border:1px solid var(--soft); outline:none; font-family:var(--mono); }

    /* --- SIMULATION VISUALS --- */
    
    /* Stack Visual */
    #stack-visual {
        width: 140px; height: 220px; 
        border-left: 4px solid var(--ink); border-right: 4px solid var(--ink); border-bottom: 4px solid var(--ink);
        background: rgba(241, 245, 249, 0.5); border-radius: 0 0 8px 8px;
        display: flex; flex-direction: column-reverse; 
        padding: 5px; gap: 5px; margin: 20px auto;
        position: relative;
    }
    
    /* Queue Visual */
    #queue-visual {
        width: 100%; height: 80px;
        border-top: 4px solid var(--ink); border-bottom: 4px solid var(--ink);
        background: rgba(241, 245, 249, 0.5);
        display: flex; align-items: center; justify-content: flex-start;
        padding: 5px; gap: 5px; margin: 40px 0; overflow: hidden;
        position:relative;
    }
    #queue-visual::before { content: "OUT ‚Üê"; position: absolute; left: -50px; font-weight:bold; color:var(--muted); font-size:12px; }
    #queue-visual::after { content: "‚Üê IN"; position: absolute; right: -40px; font-weight:bold; color:var(--muted); font-size:12px; }

    /* Common Item Style */
    .data-item {
        background: var(--accent); color: white;
        border-radius: 4px; display: grid; place-items: center;
        font-weight: bold; font-family: var(--mono);
        transition: all 0.2s ease;
    }
    .stack-item { width: 100%; height: 40px; animation: dropIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .queue-item { width: 60px; height: 60px; flex-shrink:0; animation: slideLeft 0.3s ease; }

    /* Hash Visual */
    .hash-row { display: grid; grid-template-columns: 60px 1fr; gap: 10px; margin-bottom: 6px; }
    .hash-index { background: var(--soft2); border: 1px solid var(--soft); border-radius: 4px; display: grid; place-items: center; font-family: var(--mono); font-size: 14px; color: var(--muted); }
    .hash-slot { border: 1px dashed var(--soft); border-radius: 4px; height: 40px; display: flex; align-items: center; padding-left: 10px; font-family: var(--mono); font-size: 14px; transition: background 0.3s; }
    .hash-slot.filled { background: #dcfce7; border-style: solid; border-color: var(--accent); color: #14532d; font-weight: bold; }

    @keyframes dropIn { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes slideLeft { from { opacity: 0; transform: translateX(20px); } to { opacity: 1; transform: translateX(0); } }
    
  </style>
</head>

<body>
  <div id="progress-container"><div id="progress-bar"></div></div>

  <div class="stage">
    <div class="deck-wrap" id="deckWrap">
      <div class="deck" id="deck">

        <section class="slide active">
          <div class="slide-top">
            <div class="meta">
              <div class="course">COIS 2020H</div>
              <div class="sub">Data Structures</div>
            </div>
            <span class="pill">Lecture 5</span>
          </div>
          
          <h1>Stack, Queues<br>and Hash Tables</h1>
          <h2 style="margin-top:0; border:none; color:var(--muted);">Fundamental Abstract Data Types</h2>
          
          <div class="card" style="margin-top: 22px;">
            <p style="margin:0;"><strong>Instructor:</strong> Ahmad Mousa<br /><span class="muted">Trent University - GTA</span></p>
            <div class="grid-3" style="margin-top:16px;">
                <div class="info-card"><div style="font-size:12px; font-weight:800; color:var(--muted);">FOCUS</div><div style="font-weight:900;">Linear Structures</div></div>
                <div class="info-card"><div style="font-size:12px; font-weight:800; color:var(--muted);">TYPE</div><div style="font-weight:900;">Visual Demo</div></div>
                <div class="info-card"><div style="font-size:12px; font-weight:800; color:var(--muted);">TECH</div><div style="font-weight:900;">C#</div></div>
            </div>
          </div>
          
          <div class="slide-footer"><div class="muted">Based on lecture notes by Brian Srivastava & Alaa Alslaity</div><div class="slide-no" data-slide-no></div></div>
        </section>


        <section class="slide">
          <div class="slide-top">
            <div class="meta"><div class="course">Part 1</div><div class="sub">The Stack</div></div>
            <span class="pill">LIFO</span>
          </div>
          
          <h2>Stack: Last-In, First-Out</h2>
          
          <div class="grid-2">
            <div>
              <p>A <strong>Stack</strong> adds and removes items from the same end (the top).</p>
              <ul style="margin-top:20px;">
                <li><code>Push()</code>: Adds element to top.</li>
                <li><code>Pop()</code>: Removes element from top.</li>
              </ul>
              <div class="callout">
                <p style="margin:0; font-size:0.9em;"><strong>Analogy:</strong> A stack of plates. You can't take the bottom one without removing the top ones first.</p>
              </div>
            </div>
            
            <div class="card" style="display:flex; flex-direction:column; align-items:center; min-height:400px; padding:20px;">
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <button class="mini-btn" onclick="pushStack()" style="background:var(--accent); border-color:var(--accent);">+ Push</button>
                    <button class="mini-btn" onclick="popStack()" style="background:#ef4444; border-color:#ef4444;">- Pop</button>
                </div>
                <div id="stack-visual">
                    <div class="data-item stack-item">A</div>
                    <div class="data-item stack-item" style="opacity:0.8">B</div>
                </div>
                <div class="muted" style="font-size:14px; margin-top:10px;">Stack Bottom</div>
            </div>
          </div>
          
          <div class="slide-footer"><div class="muted">Lecture 5 Stack, Queues
and Hash Tables</div><div class="slide-no" data-slide-no></div></div>
        </section>


        <section class="slide">
            <div class="slide-top">
              <div class="meta"><div class="course">Part 2</div><div class="sub">The Queue</div></div>
              <span class="pill">FIFO</span>
            </div>
            
            <h2>Queue: First-In, First-Out</h2>
            
            <div class="grid-2">
              <div>
                <p>A <strong>Queue</strong> adds items to the back and removes them from the front.</p>
                <ul style="margin-top:20px;">
                  <li><code>Enqueue()</code>: Adds element to rear.</li>
                  <li><code>Dequeue()</code>: Removes element from front.</li>
                </ul>
                <div class="callout">
                  <p style="margin:0; font-size:0.9em;"><strong>Analogy:</strong> A lineup at a coffee shop. The first person in line is the first served.</p>
                </div>
              </div>
              
              <div class="card" style="display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:400px; padding:20px;">
                  <div style="display:flex; gap:10px; margin-bottom:20px;">
                      <button class="mini-btn" onclick="enqueue()" style="background:var(--accent); border-color:var(--accent);">+ Enqueue</button>
                      <button class="mini-btn" onclick="dequeue()" style="background:#ef4444; border-color:#ef4444;">- Dequeue</button>
                  </div>
                  
                  <div style="width:100%; padding:0 30px;">
                    <div id="queue-visual">
                        <div class="data-item queue-item">1</div>
                        <div class="data-item queue-item">2</div>
                        <div class="data-item queue-item">3</div>
                    </div>
                  </div>
                  
                  <div class="muted" style="font-size:14px; margin-top:10px;">Front (Head) ‚üµ ‚üµ ‚üµ Rear (Tail)</div>
              </div>
            </div>
            
            <div class="slide-footer"><div class="muted">Lecture 5 Stack, Queues
and Hash Tables</div><div class="slide-no" data-slide-no></div></div>
        </section>


        <section class="slide">
            <div class="slide-top">
              <div class="meta"><div class="course">Part 3</div><div class="sub">Hash Table</div></div>
              <span class="pill">Key-Value</span>
            </div>
            
            <h2>Hash Table: Fast Lookups</h2>
            
            <div class="grid-2">
              <div>
                <p>A <strong>Hash Table</strong> uses a "hash function" to map a key (like a name) to an index in an array.</p>
                <ul style="margin-top:20px;">
                  <li><strong>Key:</strong> The data to store.</li>
                  <li><strong>Hash Function:</strong> <code>Key % Size</code> (Simple Modulo)</li>
                  <li><strong>Collision:</strong> When two keys map to the same slot.</li>
                </ul>
                <div class="callout" style="margin-top:20px;">
                    <div style="display:flex; gap:10px; align-items:center;">
                        <input type="text" id="hashInput" placeholder="Enter a number (e.g., 42)" style="width:200px;">
                        <button class="mini-btn" onclick="insertHash()">Insert Key</button>
                    </div>
                    <p style="margin:10px 0 0 0; font-size:0.8em; color:var(--muted);">Enter an integer to see where it lands (Size = 5).</p>
                </div>
              </div>
              
              <div class="card" style="min-height:400px; padding:20px; overflow-y:auto;">
                  <div style="font-weight:800; margin-bottom:15px; text-align:center;">Array Storage (Size: 5)</div>
                  
                  <div id="hash-table-visual">
                      </div>
              </div>
            </div>
            
            <div class="slide-footer"><div class="muted">Lecture 5 Stack, Queues
and Hash Tables</div><div class="slide-no" data-slide-no></div></div>
        </section>
<section class="slide">
  <style>
    .code-block {
      font-family: var(--mono); font-size: 15px; background: #1e293b; color: #f8fafc;
      padding: 18px; border-radius: 12px; line-height: 1.5; overflow-x: auto;
      border: 1px solid #334155; box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
    }
    .code-line { display: block; padding: 0 6px; border-radius: 4px; transition: background 0.1s; }
    .code-line.active { background: #3b82f6; color: white; font-weight: bold; transform: translateX(4px); }
    .comment { color: #94a3b8; font-style: italic; }
    .keyword { color: #c084fc; }
    .method { color: #60a5fa; }
    .num { color: #fca5a5; }

    /* Memory Visual Styles */
    .mem-container { border: 2px solid var(--ink); border-radius: 8px; background: #fff; overflow: hidden; }
    .mem-header { 
      display: grid; grid-template-columns: 40px 1fr 50px; 
      background: var(--soft2); padding: 8px; font-size: 12px; font-weight: 800; color: var(--muted); border-bottom: 2px solid var(--ink);
    }
    .mem-row { 
      display: grid; grid-template-columns: 40px 1fr 50px; 
      height: 40px; align-items: center; border-bottom: 1px solid var(--soft);
    }
    .mem-ptr { font-size: 12px; font-weight: 900; color: #ef4444; text-align: right; padding-right: 5px; opacity: 0; transition: opacity 0.2s; }
    .mem-ptr.show { opacity: 1; }
    .mem-idx { font-family: var(--mono); color: var(--muted); font-size: 13px; text-align: center; border-right: 1px solid var(--soft); }
    .mem-val { font-family: var(--mono); font-weight: bold; color: var(--ink); text-align: center; transition: all 0.3s; }
    .mem-val.dirty { background: #dbeafe; color: #1e40af; } /* Highlight change */
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Deep Dive</div><div class="sub">Stack Implementation</div></div>
    <span class="pill">Code Execution</span>
  </div>

  <h2>Stack: Under the Hood</h2>

  <div class="grid-2">
    <div>
      <p style="font-size:18px; margin-bottom:12px;">The array-based stack uses an index <code>top</code> to track the last item.</p>
      
      <div class="code-block" id="code-display">
        <span class="code-line" id="ln-1"><span class="keyword">int</span>[] stack = <span class="keyword">new int</span>[5];</span>
        <span class="code-line" id="ln-2"><span class="keyword">int</span> top = -1;</span>
        <br>
        <span class="code-line" id="ln-3"><span class="keyword">void</span> <span class="method">Push</span>(<span class="keyword">int</span> val) {</span>
        <span class="code-line" id="ln-4">  <span class="keyword">if</span> (top == 4) <span class="keyword">return</span>; <span class="comment">// Full</span></span>
        <span class="code-line" id="ln-5">  top++;</span>
        <span class="code-line" id="ln-6">  stack[top] = val;</span>
        <span class="code-line" id="ln-7">}</span>
        <br>
        <span class="code-line" id="ln-8"><span class="keyword">int</span> <span class="method">Pop</span>() {</span>
        <span class="code-line" id="ln-9">  <span class="keyword">if</span> (top == -1) <span class="keyword">return</span> -1; <span class="comment">// Empty</span></span>
        <span class="code-line" id="ln-10">  <span class="keyword">int</span> item = stack[top];</span>
        <span class="code-line" id="ln-11">  top--;</span>
        <span class="code-line" id="ln-12">  <span class="keyword">return</span> item;</span>
        <span class="code-line" id="ln-13">}</span>
      </div>

      <div class="callout" style="padding:15px; display:flex; gap:12px; align-items:center; background:#f0f9ff; border-color:#3b82f6;">
        <button class="mini-btn" onclick="execPush()" style="background:#3b82f6; border-color:#3b82f6;">‚ñ∂ Run Push()</button>
        <button class="mini-btn" onclick="execPop()" style="background:#ef4444; border-color:#ef4444;">‚ñ∂ Run Pop()</button>
        <div id="exec-status" style="font-family:var(--mono); font-size:13px; color:var(--ink); margin-left:auto; font-weight:bold;">Waiting...</div>
      </div>
    </div>

    <div class="card" style="padding:20px;">
      <div style="display:flex; justify-content:space-between; align-items:end; margin-bottom:10px;">
        <h3 style="margin:0; font-size:20px;">Memory Map</h3>
        <div style="font-family:var(--mono); font-size:14px;">top = <span id="val-top" style="color:#ef4444; font-weight:900;">-1</span></div>
      </div>

      <div class="mem-container">
        <div class="mem-header">
          <div>PTR</div><div>VALUE</div><div>IDX</div>
        </div>
        <div id="memory-grid">
          </div>
      </div>

      <div style="margin-top:15px; font-size:16px; color:var(--muted); line-height:1.4;">
        <strong>Visual Guide:</strong><br>
        The <span style="color:#ef4444; font-weight:bold;">TOP</span> pointer tracks the current height. When we <code>Pop</code>, we simply move the pointer down; the data often remains in memory (ghost data) until overwritten.
      </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Interactive Debugger View</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // Scoped variables to prevent conflicts
      const memGrid = document.getElementById("memory-grid");
      const valTopDisplay = document.getElementById("val-top");
      const statusDisplay = document.getElementById("exec-status");
      
      let internalStack = [0,0,0,0,0];
      let topIndex = -1;
      let isRunning = false;

      function render() {
        memGrid.innerHTML = "";
        // Render from top (4) down to (0)
        for(let i=4; i>=0; i--){
           const isTop = (i === topIndex);
           memGrid.innerHTML += `
             <div class="mem-row">
               <div class="mem-ptr ${isTop ? 'show' : ''}">TOP</div>
               <div class="mem-val" id="cell-${i}" style="color:${internalStack[i]===0?'#cbd5e1':'#0f172a'}">${internalStack[i]}</div>
               <div class="mem-idx">${i}</div>
             </div>
           `;
        }
        valTopDisplay.innerText = topIndex;
      }

      function highlight(line, txt) {
        document.querySelectorAll('.code-line').forEach(el => el.classList.remove('active'));
        const ln = document.getElementById(line);
        if(ln) ln.classList.add('active');
        if(txt) statusDisplay.innerText = txt;
      }

      // Expose functions globally for the buttons to work
      window.execPush = function() {
        if(isRunning) return;
        if(topIndex >= 4) { alert("Stack Overflow!"); return; }
        isRunning = true;
        const val = Math.floor(Math.random() * 89) + 10;

        highlight('ln-3', `Push(${val}) called`);

        setTimeout(() => { highlight('ln-4', 'Checking capacity...'); }, 800);
        
        setTimeout(() => { 
          topIndex++; 
          render(); 
          highlight('ln-5', 'top++ (Increment Index)'); 
        }, 1600);
        
        setTimeout(() => { 
          internalStack[topIndex] = val; 
          render();
          document.getElementById(`cell-${topIndex}`).classList.add('dirty');
          highlight('ln-6', `stack[${topIndex}] = ${val}`); 
        }, 2400);

        setTimeout(() => { 
          highlight(null, 'Ready'); 
          isRunning = false; 
        }, 3200);
      };

      window.execPop = function() {
        if(isRunning) return;
        if(topIndex === -1) { alert("Stack Underflow!"); return; }
        isRunning = true;

        highlight('ln-8', 'Pop() called');

        setTimeout(() => { highlight('ln-9', 'Checking if empty...'); }, 800);

        setTimeout(() => { highlight('ln-10', `Reading stack[${topIndex}]...`); }, 1600);

        setTimeout(() => { 
          topIndex--; 
          render(); 
          highlight('ln-11', 'top-- (Decrement Index)'); 
        }, 2400);

        setTimeout(() => { 
          highlight('ln-12', 'Return Item'); 
        }, 3200);

        setTimeout(() => { 
          highlight(null, 'Ready'); 
          isRunning = false; 
        }, 4000);
      };

      // Init
      render();
    })();
  </script>

</section>
<section class="slide">
  <style>
    .bad-array-container {
      display: flex;
      gap: 10px;
      padding: 20px;
      background: #f1f5f9;
      border: 2px solid #cbd5e1;
      border-radius: 12px;
      overflow-x: auto;
      min-height: 100px;
      align-items: center;
      position: relative;
    }
    
    .bad-item {
      min-width: 80px;
      height: 60px;
      background: #cbd5e1; /* Default grey for existing items */
      color: #1e293b;
      font-family: var(--mono);
      font-weight: bold;
      display: grid;
      place-items: center;
      border-radius: 8px;
      position: relative;
      transition: transform 0.4s ease, background 0.3s;
      flex-shrink: 0;
      border: 2px solid #94a3b8;
    }

    /* The new item being added */
    .bad-item.new-entry {
      background: #ef4444; /* Red to signify 'expensive' operation */
      color: white;
      border-color: #b91c1c;
      animation: flashRed 1s;
    }

    /* The index 0 marker */
    .index-marker {
      position: absolute;
      top: -25px;
      left: 20px;
      font-family: var(--mono);
      font-size: 14px;
      color: #ef4444;
      font-weight: bold;
    }
    .index-marker::after {
      content: "‚Üì";
      display: block;
      text-align: center;
      font-size: 18px;
    }

    /* Shift Animation Helper */
    .shifting {
      transform: translateX(90px); /* Move right by item width + gap */
    }

    @keyframes flashRed {
      0% { background: #ef4444; transform: scale(1.1); }
      100% { background: #cbd5e1; transform: scale(1); }
    }
    
    .complexity-badge {
      display: inline-block;
      background: #fee2e2;
      color: #b91c1c;
      border: 1px solid #fca5a5;
      padding: 4px 8px;
      border-radius: 6px;
      font-family: var(--mono);
      font-weight: bold;
      font-size: 0.9em;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Pitfalls</div><div class="sub">Implementation Mistakes</div></div>
    <span class="pill" style="background:#fee2e2; color:#b91c1c; border-color:#fca5a5;">Anti-Pattern</span>
  </div>

  <h2>The "Shift of Shame": Pushing to Index 0</h2>

  <div class="grid-2">
    <div>
      <p>Why do we push/pop from the <strong>end</strong> of an array?</p>
      <div class="card" style="margin-top:20px; border-left: 6px solid #ef4444;">
        <h3 style="margin-top:0; color:#b91c1c; font-size:22px;">The "Bad" Stack</h3>
        <p style="font-size:18px;">If you push to <code>Index[0]</code>, existing items aren't just sitting there. They must <strong>move</strong>.</p>
        <ul style="font-size:17px; line-height:1.6;">
          <li><strong>Scenario:</strong> You insert "Alaa" at the front.</li>
          <li><strong>Consequence:</strong> "John", "Marie", and everyone else must shift index ($i + 1$).</li>
          <li><strong>Cost:</strong> <span class="complexity-badge">O(N) Linear Time</span></li>
        </ul>
      </div>
      
      <div style="margin-top:20px;">
        <div style="font-size:14px; color:var(--muted); margin-bottom:8px; font-family:var(--mono);">TRY IT:</div>
        <div style="display:flex; gap:10px;">
          <button class="mini-btn" onclick="badPush()" style="background:#ef4444; border-color:#ef4444; font-size:16px;">
            + Bad Push (Index 0)
          </button>
          <button class="mini-btn" onclick="resetBadStack()">
            Reset
          </button>
        </div>
      </div>
    </div>

    <div class="card" style="display:flex; flex-direction:column; justify-content:center; padding:20px; overflow:hidden;">
      
      <div style="text-align:center; margin-bottom:30px;">
        <div style="font-size:14px; font-weight:bold; color:var(--muted); margin-bottom:5px;">VISUALIZATION OF MEMORY</div>
        <div id="op-status" style="height:24px; color:#ef4444; font-weight:bold;">Waiting for input...</div>
      </div>

      <div style="position:relative; padding-top:30px;">
        <div class="index-marker">Index[0]</div>
        <div class="bad-array-container" id="bad-stack-container">
          <div class="bad-item">Sobie</div>
          <div class="bad-item">Jack</div>
        </div>
      </div>

      <p style="font-size:14px; color:var(--muted); margin-top:20px; text-align:center;">
        Notice how <strong>every single item</strong> has to animate to the right to make space? <br>Imagine doing this with 1 million items!
      </p>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Performance Visualization</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const container = document.getElementById("bad-stack-container");
      const status = document.getElementById("op-status");
      const names = ["Alaa", "John", "Marie", "Richard", "Steve"];
      let nameIndex = 0;
      let isAnimating = false;

      window.badPush = function() {
        if(isAnimating) return;
        if(container.children.length >= 6) { 
           alert("Array full! Reset to try again."); 
           return; 
        }
        isAnimating = true;

        // 1. Get current items
        const currentItems = Array.from(container.children);
        
        // 2. Announce the shift
        status.innerText = `‚ö† SHIFTING ${currentItems.length} ITEMS RIGHT...`;

        // 3. Apply Shift Class to visualize the "Pain"
        currentItems.forEach(item => {
          item.classList.add("shifting");
        });

        // 4. Wait for shift animation to finish, then insert
        setTimeout(() => {
          // Remove shift class (instantly snap back but we insert element before them so it looks correct)
          currentItems.forEach(item => item.classList.remove("shifting"));
          
          // Create new element
          const newName = names[nameIndex % names.length];
          const el = document.createElement("div");
          el.className = "bad-item new-entry";
          el.innerText = newName;
          
          // Insert at Index 0
          container.prepend(el);
          
          status.innerText = `Inserted "${newName}" at [0]`;
          status.style.color = "#16a34a"; // Green for success
          
          nameIndex++;
          isAnimating = false;

          // Reset status color after a bit
          setTimeout(() => { status.style.color = "#ef4444"; }, 1500);

        }, 400); // Wait 400ms for the shift animation
      };

      window.resetBadStack = function() {
        container.innerHTML = '<div class="bad-item">Sobie</div><div class="bad-item">Jack</div>';
        status.innerText = "Reset complete.";
        nameIndex = 0;
        isAnimating = false;
      }

    })();
  </script>
             

</section>
<section class="slide">
  <style>
    .sane-array-container {
      display: flex;
      gap: 12px;
      padding: 20px;
      background: #f0fdf4; /* Light green bg to signify "Good" */
      border: 2px solid #86efac;
      border-radius: 12px;
      min-height: 120px;
      align-items: center;
      justify-content: flex-start;
      overflow-x: auto;
    }
    
    .sane-item {
      min-width: 90px;
      height: 60px;
      background: #16a34a; /* Green accent */
      color: white;
      font-family: var(--mono);
      font-weight: bold;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      position: relative;
      animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    .sane-item span { pointer-events: none; }
    .idx-label { font-size: 10px; opacity: 0.8; margin-top: 2px; }

    /* The 'Top' marker that follows the end */
    .top-marker-container {
      position: relative;
      height: 20px;
      margin-top: 10px;
    }
    .top-ptr {
      position: absolute;
      color: #16a34a;
      font-weight: 900;
      font-family: var(--mono);
      font-size: 14px;
      transition: left 0.3s ease;
      bottom: 0;
    }
    .top-ptr::before { content: "‚Üë"; display: block; text-align: center; }

    @keyframes popIn {
      from { transform: scale(0.5) translateY(20px); opacity: 0; }
      to { transform: scale(1) translateY(0); opacity: 1; }
    }
    
    .complexity-badge-good {
      display: inline-block;
      background: #dcfce7;
      color: #15803d;
      border: 1px solid #86efac;
      padding: 4px 8px;
      border-radius: 6px;
      font-family: var(--mono);
      font-weight: bold;
      font-size: 0.9em;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Best Practice</div><div class="sub">Efficient Implementation</div></div>
    <span class="pill" style="background:#dcfce7; color:#15803d; border-color:#86efac;">O(1) Constant Time</span>
  </div>

  <h2>Stack using Array: The Sane Way</h2>

  <div class="grid-2">
    <div>
      <p>This is how we actually do it. We track the <strong>First Available</strong> slot (or <code>Top</code> index).</p>
      
      <div class="card" style="margin-top:20px; border-left: 6px solid #22c55e;">
        <h3 style="margin-top:0; color:#14532d; font-size:22px;">The "Good" Stack</h3>
        <p style="font-size:18px;">New items land at the end. Old items <strong>never move</strong>.</p>
        <ul style="font-size:17px; line-height:1.6;">
          <li><strong>Add:</strong> <code>array[top] = "Name"</code></li>
          <li><strong>Remove:</strong> <code>top--</code></li>
          <li><strong>Cost:</strong> <span class="complexity-badge-good">O(1) Constant Time</span></li>
        </ul>
      </div>

      <div style="margin-top:20px;">
        <div style="display:flex; gap:10px;">
          <button class="mini-btn" onclick="sanePush()" style="background:#16a34a; border-color:#16a34a; font-size:16px;">
            + Push (End)
          </button>
          <button class="mini-btn" onclick="sanePop()" style="background:#ef4444; border-color:#ef4444; font-size:16px;">
            - Pop (End)
          </button>
        </div>
        <p style="font-size:14px; color:var(--muted); margin-top:10px;">
          Next: <strong id="next-name">Alaa</strong>
        </p>
      </div>
    </div>

    <div class="card" style="display:flex; flex-direction:column; justify-content:center; padding:20px; overflow:hidden;">
      
      <div style="margin-bottom:10px; font-weight:bold; color:var(--muted); font-size:12px;">MEMORY ARRAY (0 ‚Üí N)</div>
      
      <div class="sane-array-container" id="sane-container">
        </div>
      
      <div class="top-marker-container">
        <div id="top-ptr" class="top-ptr" style="left: 20px;">TOP</div>
      </div>

      <p style="font-size:14px; color:var(--muted); margin-top:20px; text-align:center;">
        Notice how peaceful it is? "Alaa" sits at [0] forever.<br>
        We just append to the right.
      </p>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Performance Visualization</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const container = document.getElementById("sane-container");
      const nextLabel = document.getElementById("next-name");
      const ptr = document.getElementById("top-ptr");
      
      const sequence = ["Alaa", "John", "Marie", "Richard", "Sobie", "Jack"];
      let ptrIndex = 0; // Tracks logical count

      function updatePtr() {
        // Calculate visual position (width of item + gap) * count + padding
        // Item width ~90px, gap 12px, padding 20px
        const offset = 20 + (ptrIndex * 102); 
        ptr.style.left = offset + "px";
        
        // Update Label
        if(ptrIndex < sequence.length) {
            nextLabel.innerText = sequence[ptrIndex];
            nextLabel.style.color = "#16a34a";
        } else {
            nextLabel.innerText = "(Full)";
            nextLabel.style.color = "var(--muted)";
        }
      }

      window.sanePush = function() {
        if(ptrIndex >= sequence.length) { alert("Demo array is full!"); return; }

        const name = sequence[ptrIndex];
        const el = document.createElement("div");
        el.className = "sane-item";
        el.innerHTML = `<span>${name}</span><span class="idx-label">[${ptrIndex}]</span>`;
        
        container.appendChild(el);
        ptrIndex++;
        updatePtr();
      };

      window.sanePop = function() {
        if(ptrIndex === 0) { alert("Stack is empty!"); return; }
        
        const last = container.lastElementChild;
        last.style.transform = "scale(0.8) translateY(-20px)";
        last.style.opacity = "0";
        
        setTimeout(() => last.remove(), 200);
        
        ptrIndex--;
        updatePtr();
      };

      // Init Pointer
      updatePtr();

    })();
  </script>
                

</section>
<section class="slide">
  <style>
    .peek-visual-container {
      display: flex;
      flex-direction: column-reverse; /* Bottom-up stack */
      align-items: center;
      width: 140px;
      height: 280px;
      background: #f1f5f9;
      border-bottom: 4px solid var(--ink);
      border-left: 4px solid var(--ink);
      border-right: 4px solid var(--ink);
      border-radius: 0 0 12px 12px;
      padding: 10px;
      margin: 0 auto;
      position: relative;
    }

    .peek-item {
      width: 100%;
      height: 45px;
      background: var(--accent);
      color: white;
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 6px;
      margin-top: 4px;
      display: grid;
      place-items: center;
      font-family: var(--mono);
      font-weight: bold;
      transition: all 0.3s;
    }

    /* Highlight style for Peek */
    .peek-highlight {
      background: #f59e0b; /* Amber/Yellow for attention */
      transform: scale(1.05);
      box-shadow: 0 0 15px rgba(245, 158, 11, 0.6);
      z-index: 10;
    }

    /* The 'Eye' Visual */
    .eye-icon {
      position: absolute;
      right: -60px;
      font-size: 30px;
      opacity: 0;
      transition: top 0.3s, opacity 0.3s;
    }
    .eye-icon.visible { opacity: 1; animation: bounceRight 0.5s infinite alternate; }

    @keyframes bounceRight { from { transform: translateX(0); } to { transform: translateX(5px); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Operations</div><div class="sub">Non-Destructive Read</div></div>
    <span class="pill">Peek / Top</span>
  </div>

  <h2>Read Top (Peek)</h2>

  <div class="grid-2">
    <div>
      <p>Retrieves the content at the top of the stack <strong>without removing it</strong>.</p>
      <ul style="margin-bottom: 20px;">
        <li>Often called <code>Peek()</code> or <code>Top()</code>.</li>
        <li>Vital for checking state before acting.</li>
        <li><strong>Cost:</strong> O(1).</li>
      </ul>

      <div class="code-block" style="background:#1e293b; padding:15px; border-radius:10px; color:#f8fafc; font-family:var(--mono);">
        <span class="keyword">int</span> <span class="method">Peek</span>() {<br>
        &nbsp;&nbsp;<span class="keyword">if</span> (top == -1) <span class="keyword">return</span> -1; <span class="comment">// Error</span><br>
        &nbsp;&nbsp;<span class="keyword">return</span> stack[top]; <span class="comment">// Return Value only</span><br>
        }<br>
        <span class="comment">// Note: 'top' is NOT decremented!</span>
      </div>

      <div class="callout" style="margin-top:20px;">
        <div style="display:flex; gap:10px;">
           <button class="mini-btn" onclick="demoPush()" style="background:#3b82f6; border-color:#3b82f6;">+ Push Random</button>
           <button class="mini-btn" onclick="demoPeek()" style="background:#f59e0b; border-color:#f59e0b; color:white;">üëÅ Peek()</button>
        </div>
        <p id="peek-msg" style="margin-top:10px; font-family:var(--mono); font-size:14px; min-height:20px;">
          Stack Status: Ready.
        </p>
      </div>
    </div>

    <div class="card" style="display:flex; align-items:center; justify-content:center; min-height:400px;">
      
      <div class="peek-visual-container" id="peek-container">
        <div class="peek-item">10</div>
        <div class="peek-item">25</div>
        <div class="peek-item">42</div>
        
        <div id="visual-eye" class="eye-icon">üëÅÔ∏è</div>
      </div>
      
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Looking without Touching</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const container = document.getElementById("peek-container");
      const eye = document.getElementById("visual-eye");
      const msg = document.getElementById("peek-msg");

      window.demoPush = function() {
        if(container.children.length >= 6) { // 5 items + 1 eye div
           msg.innerText = "Stack full!"; 
           return; 
        }
        const val = Math.floor(Math.random() * 90 + 10);
        const el = document.createElement("div");
        el.className = "peek-item";
        el.innerText = val;
        // Insert before the eye (eye is last child usually to sit on top, but here flex-direction is reverse)
        // Actually flex-reverse means last child is at TOP visually.
        container.appendChild(el); 
        msg.innerText = `Pushed ${val}.`;
        
        // Hide eye if it was active
        resetEye();
      };

      window.demoPeek = function() {
        // Filter out the eye div to count actual items
        const items = Array.from(container.querySelectorAll('.peek-item'));
        
        if(items.length === 0) {
          msg.innerText = "Stack is empty! Nothing to peek.";
          msg.style.color = "#ef4444";
          return;
        }

        const topItem = items[items.length - 1];
        const val = topItem.innerText;

        // 1. Position Eye
        // We need to find where the top item is visually
        // Since it's flex-col-reverse, the last DOM element is at the TOP.
        // Let's just set the eye to the top of the container for simplicity in this demo structure
        const itemHeight = 49; // 45px + 4px margin
        const totalHeight = items.length * itemHeight;
        
        eye.style.bottom = (totalHeight - 25) + "px"; // Align with top item
        eye.classList.add("visible");

        // 2. Highlight Item
        topItem.classList.add("peek-highlight");

        // 3. Message
        msg.innerHTML = `Peek returned <strong>${val}</strong>.<br><span style='color:#64748b'>Pointer 'top' did not change.</span>`;
        msg.style.color = "var(--ink)";

        // 4. Reset style after 1.5s
        setTimeout(() => {
          topItem.classList.remove("peek-highlight");
          resetEye();
        }, 1500);
      };

      function resetEye() {
        eye.classList.remove("visible");
      }

    })();
  </script>
                  

</section>
<section class="slide">
  <style>
    .feature-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-top: 20px;
    }

    .feature-card {
      background: white;
      border: 1px solid var(--soft);
      border-radius: 12px;
      padding: 20px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .feature-card.core {
      border-color: var(--accent);
      background: #f0fdf4; /* Green tint */
      box-shadow: 0 10px 30px -10px rgba(22, 163, 74, 0.2);
    }

    .feature-card.extra {
      border-color: var(--soft);
      background: #f8fafc; /* Grey tint */
      opacity: 0.85;
    }
    .feature-card.extra:hover { opacity: 1; transform: translateY(-2px); }

    .icon-badge {
      width: 40px; height: 40px;
      border-radius: 8px;
      display: grid; place-items: center;
      font-size: 20px;
      margin-bottom: 12px;
    }
    
    .status-tag {
      position: absolute;
      top: 20px; right: 20px;
      font-size: 11px;
      font-weight: 800;
      padding: 4px 8px;
      border-radius: 99px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Animation for the 'Scanner' (Search) */
    .scan-line {
      position: absolute;
      left: 0; width: 100%; height: 2px;
      background: #3b82f6;
      box-shadow: 0 0 4px #3b82f6;
      top: 0;
      animation: scanDown 2s infinite linear;
      display: none;
    }
    .searching .scan-line { display: block; }
    
    @keyframes scanDown { 0%{top:0} 100%{top:100%} }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Extended Features</div><div class="sub">Auxiliary Operations</div></div>
    <span class="pill">Utility Methods</span>
  </div>

  <h2>Beyond Push & Pop</h2>

  <div class="grid-2">
    <div>
      <p>A Stack is just a wrapper around an Array or Linked List. You <em>can</em> add other features, but they are secondary.</p>
      
      <div style="margin-top:25px;">
        <h3 style="font-size:20px; color:var(--ink);">Common Utilities:</h3>
        <ul style="line-height:1.8;">
          <li><strong>Print All:</strong> Useful for debugging, but violates the "Encapsulation" principle of a pure stack.</li>
          <li><strong>Search (Contains):</strong> Check if an item exists without popping everything off.</li>
          <li><strong>Clear (Delete All):</strong> Reset the stack pointer to -1 (or null).</li>
        </ul>
      </div>

      <div class="callout" style="border-left-color:#f59e0b; background:#fffbeb;">
        <strong>Note:</strong> In a strict mathematical stack, you can <em>only</em> see the top element. In practical programming (C#, Java), we often allow iteration/searching for convenience.
      </div>
    </div>

    <div>
      
      <div class="feature-card core" style="margin-bottom:15px;">
        <div class="status-tag" style="background:#dcfce7; color:#166534;">Defining Feature</div>
        <div class="icon-badge" style="background:#dcfce7; color:#166534;">‚ö°</div>
        <h4 style="margin:0 0 5px 0; font-size:18px;">Push / Pop</h4>
        <p style="margin:0; font-size:14px; color:var(--muted);">
          The soul of the data structure. Without LIFO behavior, it is not a stack.
        </p>
      </div>

      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;">
        
        <div class="feature-card extra" id="search-card">
          <div class="scan-line"></div>
          <div class="status-tag" style="background:#e2e8f0; color:#475569;">Utility</div>
          <div class="icon-badge" style="background:#e0f2fe; color:#0369a1;">üîç</div>
          <h4 style="margin:0 0 5px 0; font-size:16px;">Search()</h4>
          <button class="mini-btn" onclick="demoSearch()" style="width:100%; margin-top:10px;">Simulate Scan</button>
        </div>

        <div class="feature-card extra">
          <div class="status-tag" style="background:#e2e8f0; color:#475569;">Utility</div>
          <div class="icon-badge" style="background:#fee2e2; color:#b91c1c;">üóë</div>
          <h4 style="margin:0 0 5px 0; font-size:16px;">Clear()</h4>
          <button class="mini-btn" onclick="demoClear(this)" style="width:100%; margin-top:10px; background:#fff; color:#b91c1c; border-color:#b91c1c;">Reset Data</button>
        </div>
        
        <div class="feature-card extra" style="grid-column: span 2;">
          <div class="status-tag" style="background:#e2e8f0; color:#475569;">Debug</div>
          <div class="icon-badge" style="background:#f3e8ff; color:#7e22ce;">üñ®</div>
          <h4 style="margin:0 0 5px 0; font-size:16px;">PrintAll()</h4>
          <div style="font-family:var(--mono); font-size:12px; color:var(--muted); background:#f1f5f9; padding:8px; border-radius:6px; margin-top:5px;">
            [Top] -> 10 -> 45 -> 99 -> [Bottom]
          </div>
        </div>

      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Stack Extensions</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // Search Animation Logic
      window.demoSearch = function() {
        const card = document.getElementById("search-card");
        const btn = card.querySelector("button");
        
        if(card.classList.contains("searching")) return;
        
        card.classList.add("searching");
        btn.innerText = "Scanning...";
        
        setTimeout(() => {
          card.classList.remove("searching");
          btn.innerText = "Found Index [2]";
          setTimeout(() => btn.innerText = "Simulate Scan", 1500);
        }, 2000);
      };

      // Clear Animation Logic
      window.demoClear = function(btn) {
        const originalText = btn.innerText;
        btn.innerText = "Stack Cleared!";
        btn.style.background = "#b91c1c";
        btn.style.color = "white";
        
        setTimeout(() => {
          btn.innerText = originalText;
          btn.style.background = "#fff";
          btn.style.color = "#b91c1c";
        }, 1500);
      };
    })();
  </script>
                    

</section>
<section class="slide">
  <style>
    /* Tab System */
    .app-tabs { display: flex; gap: 10px; margin-bottom: 15px; border-bottom: 1px solid var(--soft); padding-bottom: 10px; }
    .app-tab { 
      background: transparent; border: none; color: var(--muted); font-weight: bold; cursor: pointer; padding: 5px 10px; transition: color 0.2s; 
      font-family: var(--sans); font-size: 16px;
    }
    .app-tab.active { color: var(--accent); border-bottom: 2px solid var(--accent); }

    /* Content Area */
    .app-content { display: none; animation: fadeIn 0.3s ease; }
    .app-content.active { display: block; }

    /* Reverser Visuals */
    .rev-container { display: flex; align-items: center; gap: 15px; margin-top: 15px; }
    .rev-box { border: 1px solid var(--soft); padding: 10px; border-radius: 8px; background: #f8fafc; font-family: var(--mono); min-width: 60px; text-align: center; }
    .rev-arrow { color: var(--accent); font-weight: bold; font-size: 20px; }

    /* Parser Visuals */
    .parse-result { margin-top: 10px; font-weight: bold; font-family: var(--mono); }
    .valid { color: #16a34a; }
    .invalid { color: #ef4444; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Real World</div><div class="sub">Practical Uses</div></div>
    <span class="pill">Applications</span>
  </div>

  <h2>Stack Applications</h2>

  <div class="grid-2">
    <div>
      <p>Stacks are essential for scenarios requiring <strong>Backtracking</strong> or <strong>Last-In processing</strong>.</p>
      
      <div style="margin-top:20px;">
        <div class="info-card" onclick="switchAppTab('tab-rev')" style="cursor:pointer; margin-bottom:12px;">
            <div style="font-weight:bold; color:var(--ink);">1. Reversing Data</div>
            <div style="font-size:14px; color:var(--muted);">Pushing items and popping them naturally reverses their order.</div>
        </div>

        <div class="info-card" onclick="switchAppTab('tab-par')" style="cursor:pointer; margin-bottom:12px;">
            <div style="font-weight:bold; color:var(--ink);">2. Parsing & Syntax</div>
            <div style="font-size:14px; color:var(--muted);">Compilers use stacks to check balanced parentheses <code>(( ))</code>.</div>
        </div>

        <div class="info-card" style="cursor:default; opacity:0.8;">
            <div style="font-weight:bold; color:var(--ink);">3. Backtracking</div>
            <div style="font-size:14px; color:var(--muted);">Used in maze solving, browser history, and "Undo" buttons (Ctrl+Z).</div>
        </div>
      </div>
    </div>

    <div class="card" style="min-height:450px; padding:20px;">
      
      <div class="app-tabs">
        <button class="app-tab active" onclick="switchAppTab('tab-rev')">Reversing</button>
        <button class="app-tab" onclick="switchAppTab('tab-par')">Parsing</button>
      </div>

      <div id="tab-rev" class="app-content active">
        <div class="code-block" style="font-size:13px; margin-bottom:15px;">
<span class="keyword">string</span> Reverse(<span class="keyword">string</span> input) {
  Stack&lt;<span class="keyword">char</span>&gt; s = <span class="keyword">new</span> Stack&lt;<span class="keyword">char</span>&gt;();
  <span class="comment">// 1. Fill Stack</span>
  <span class="keyword">foreach</span>(<span class="keyword">char</span> c <span class="keyword">in</span> input) s.Push(c);
  
  <span class="comment">// 2. Empty Stack (LIFO)</span>
  <span class="keyword">string</span> out = <span class="string">""</span>;
  <span class="keyword">while</span>(s.Count > 0) out += s.Pop();
  <span class="keyword">return</span> out;
}
        </div>

        <div style="background:var(--soft2); padding:15px; border-radius:8px;">
            <div style="font-size:12px; font-weight:bold; color:var(--muted); margin-bottom:5px;">INTERACTIVE DEMO</div>
            <input type="text" id="revInput" value="HELLO" maxlength="6" style="width:100px; text-transform:uppercase;">
            <button class="mini-btn" onclick="runReverse()">Reverse</button>
            
            <div class="rev-container">
                <div class="rev-box" id="rev-in">HELLO</div>
                <div class="rev-arrow">‚ûî</div>
                <div class="rev-box" style="border-color:var(--accent); background:#dcfce7;" id="rev-stack">[ ||||| ]</div>
                <div class="rev-arrow">‚ûî</div>
                <div class="rev-box" id="rev-out">???</div>
            </div>
            <div id="rev-status" style="margin-top:10px; font-size:12px; color:var(--muted); min-height:18px;"></div>
        </div>
      </div>

      <div id="tab-par" class="app-content">
         <div class="code-block" style="font-size:13px; margin-bottom:15px;">
<span class="keyword">bool</span> CheckBalanced(<span class="keyword">string</span> expr) {
  Stack&lt;<span class="keyword">char</span>&gt; s = <span class="keyword">new</span> Stack&lt;<span class="keyword">char</span>&gt;();
  <span class="keyword">foreach</span>(<span class="keyword">char</span> c <span class="keyword">in</span> expr) {
    <span class="keyword">if</span> (c == <span class="string">'('</span>) s.Push(c);
    <span class="keyword">else if</span> (c == <span class="string">')'</span>) {
      <span class="keyword">if</span> (s.Count == 0) <span class="keyword">return false</span>;
      s.Pop();
    }
  }
  <span class="keyword">return</span> s.Count == 0;
}
        </div>

        <div style="background:var(--soft2); padding:15px; border-radius:8px;">
            <div style="font-size:12px; font-weight:bold; color:var(--muted); margin-bottom:5px;">PARENTHESES CHECKER</div>
            <div style="display:flex; gap:5px;">
                <input type="text" id="parseInput" value="( ( ) )" style="width:150px; font-family:var(--mono);">
                <button class="mini-btn" onclick="runParse()">Check</button>
            </div>
            <div id="parseResult" class="parse-result"></div>
        </div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Common Algorithms</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // Tab Switching
      window.switchAppTab = function(tabId) {
        // 1. Hide all content
        document.querySelectorAll('.app-content').forEach(el => el.classList.remove('active'));
        // 2. Deactivate all buttons
        document.querySelectorAll('.app-tab').forEach(el => el.classList.remove('active'));
        
        // 3. Activate target
        document.getElementById(tabId).classList.add('active');
        // Find button that calls this func (simple approximation)
        const btns = document.querySelectorAll('.app-tab');
        if(tabId === 'tab-rev') btns[0].classList.add('active');
        if(tabId === 'tab-par') btns[1].classList.add('active');
      };

      // --- REVERSE DEMO ---
      window.runReverse = function() {
        const input = document.getElementById('revInput').value || "HELLO";
        const inBox = document.getElementById('rev-in');
        const stackBox = document.getElementById('rev-stack');
        const outBox = document.getElementById('rev-out');
        const status = document.getElementById('rev-status');

        inBox.innerText = input;
        outBox.innerText = "";
        stackBox.innerText = "[ ]";
        
        let chars = input.split('');
        let stack = [];

        // Animation Sequence
        status.innerText = "Pushing to Stack...";
        
        let i = 0;
        const pushInterval = setInterval(() => {
            if(i < chars.length) {
                stack.push(chars[i]);
                stackBox.innerText = `[ ${stack.join(' ')} ]`;
                inBox.innerText = input.substring(i+1); // Visual remove from input
                i++;
            } else {
                clearInterval(pushInterval);
                startPop();
            }
        }, 300);

        function startPop() {
            status.innerText = "Popping (LIFO)...";
            let outStr = "";
            const popInterval = setInterval(() => {
                if(stack.length > 0) {
                    const c = stack.pop();
                    stackBox.innerText = `[ ${stack.join(' ')} ]`;
                    outStr += c;
                    outBox.innerText = outStr;
                } else {
                    clearInterval(popInterval);
                    status.innerText = "Reversal Complete.";
                    inBox.innerText = input; // Reset input view
                }
            }, 300);
        }
      };

      // --- PARSE DEMO ---
      window.runParse = function() {
        const str = document.getElementById('parseInput').value;
        const resBox = document.getElementById('parseResult');
        let balance = 0;
        let valid = true;

        // Simple logic for visual demo
        for(let c of str) {
            if(c === '(') balance++;
            else if(c === ')') {
                if(balance === 0) { valid = false; break; }
                balance--;
            }
        }
        if(balance !== 0) valid = false;

        if(valid) {
            resBox.innerHTML = "Result: <span class='valid'>‚úî BALANCED</span>";
        } else {
            resBox.innerHTML = "Result: <span class='invalid'>‚úò INVALID SYNTAX</span>";
        }
      };

    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Visual Container for the Reversal Process */
    .rev-demo-stage {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      padding: 20px;
    }

    /* The Stack Container */
    .visual-stack-container {
      width: 80px;
      height: 200px;
      border-left: 4px solid var(--ink);
      border-right: 4px solid var(--ink);
      border-bottom: 4px solid var(--ink);
      border-radius: 0 0 8px 8px;
      background: rgba(255,255,255,0.5);
      display: flex;
      flex-direction: column-reverse; /* Bottom fills first */
      padding: 5px;
      gap: 2px;
      margin: 20px 0;
      position: relative;
    }

    /* Individual Char Blocks */
    .char-block {
      width: 100%;
      height: 35px;
      background: var(--accent);
      color: white;
      font-family: var(--mono);
      font-weight: bold;
      display: grid;
      place-items: center;
      border-radius: 4px;
      animation: dropInRev 0.3s ease;
    }

    /* String Arrays */
    .string-display {
      font-family: var(--mono);
      font-size: 24px;
      letter-spacing: 5px;
      min-height: 40px;
      border-bottom: 2px solid var(--soft);
      padding: 5px 10px;
      display: inline-block;
    }

    @keyframes dropInRev { from { opacity:0; transform:translateY(-20px); } to { opacity:1; transform:translateY(0); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Algorithm</div><div class="sub">Stack Applications</div></div>
    <span class="pill">String Reversal</span>
  </div>

  <h2>Reversing Data with a Stack</h2>

  <div class="grid-2">
    <div>
      <p style="margin-bottom:15px;">Because a Stack is <strong>LIFO</strong>, pushing a sequence and popping it automatically reverses the order.</p>
      
     <div class="code-block" style="font-size:14px; font-family: 'Consolas', monospace; line-height: 1.6; white-space: pre;">
<span class="keyword">public static void</span> ReverseString(<span class="keyword">char</span>[] str) 
{
    <span class="comment">// 1. Create Stack with capacity 'n'</span>
    <span class="keyword">int</span> n = str.Length;
    Stack&lt;<span class="keyword">char</span>&gt; stack = <span class="keyword">new</span> Stack&lt;<span class="keyword">char</span>&gt;(n);

    <span class="comment">// 2. Push all characters (Fill the Stack)</span>
    <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; n; i++) {
        stack.Push(str[i]);
    }

    <span class="comment">// 3. Pop back (Last-In is First-Out)</span>
    <span class="keyword">for</span> (<span class="keyword">int</span> i = 0; i &lt; n; i++) {
        <span class="keyword">char</span> ch = stack.Pop();
        str[i] = ch; <span class="comment">// Overwrite original array</span>
    }
}
</div>

      <div class="callout">
        <strong>Logic:</strong> The first character pushed (Index 0) settles at the bottom. It will be the <em>last</em> one popped.
      </div>
    </div>

    <div class="card" style="padding:0;">
      <div class="rev-demo-stage">
        
        <div style="text-align:center;">
          <div style="font-size:12px; color:var(--muted); font-weight:bold;">ORIGINAL STRING</div>
          <div id="str-input" class="string-display">TRENT</div>
        </div>

        <div style="display:flex; align-items:center; gap:20px;">
          <div style="font-size:30px; color:var(--muted);">‚§µ</div>
          <div class="visual-stack-container" id="rev-stack-visual">
             </div>
          <div style="font-size:30px; color:var(--muted);">‚§¥</div>
        </div>

        <div style="text-align:center;">
          <div style="font-size:12px; color:var(--muted); font-weight:bold;">REVERSED STRING</div>
          <div id="str-output" class="string-display" style="color:var(--accent); border-color:var(--accent);"></div>
        </div>

        <div style="margin-top:20px;">
          <button class="mini-btn" onclick="visualizeReverse()" style="padding: 10px 20px; font-size:16px;">‚ñ∂ Run Visualization</button>
        </div>

      </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing LIFO Reversal</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const stackContainer = document.getElementById("rev-stack-visual");
      const inputDisplay = document.getElementById("str-input");
      const outputDisplay = document.getElementById("str-output");
      
      const originalText = "TRENT";
      let isRunning = false;

      window.visualizeReverse = function() {
        if(isRunning) return;
        isRunning = true;
        
        // Reset
        stackContainer.innerHTML = "";
        outputDisplay.innerText = "";
        inputDisplay.innerText = originalText;
        
        let chars = originalText.split('');
        let i = 0;

        // PHASE 1: PUSH
        let pushInterval = setInterval(() => {
            if(i < chars.length) {
                // Add to stack visual
                const el = document.createElement("div");
                el.className = "char-block";
                el.innerText = chars[i];
                stackContainer.appendChild(el);
                
                // Dim the letter in original string to show it's "moved"
                let currentText = inputDisplay.innerText;
                inputDisplay.innerText = currentText.substring(1); // naive removal for visual effect
                
                i++;
            } else {
                clearInterval(pushInterval);
                setTimeout(startPop, 500);
            }
        }, 400);

        // PHASE 2: POP
        function startPop() {
            let popInterval = setInterval(() => {
                if(stackContainer.children.length > 0) {
                    // Remove from stack
                    const top = stackContainer.lastElementChild;
                    const char = top.innerText;
                    top.remove();
                    
                    // Add to output
                    outputDisplay.innerText += char;
                } else {
                    clearInterval(popInterval);
                    isRunning = false;
                    // Restore input text for looks
                    inputDisplay.innerText = originalText; 
                    inputDisplay.style.color = "var(--muted)";
                }
            }, 400);
        }
      };
    })();
  </script>
                       

</section>

<section class="slide">
  <style>
    /* Container for the Parsing Visual */
    .parser-stage {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
    }

    /* The Input String Tape */
    .tape-container {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      padding: 10px;
      background: #f1f5f9;
      border-radius: 8px;
    }
    .tape-char {
      width: 30px; height: 35px;
      display: grid; place-items: center;
      font-family: var(--mono); font-weight: bold;
      background: white; border: 1px solid var(--soft);
      border-radius: 4px;
      transition: all 0.2s;
    }
    .tape-char.active {
      background: #3b82f6; color: white; transform: scale(1.1); border-color: #2563eb;
    }

    /* The Stack Visual */
    .parser-stack {
      width: 70px;
      height: 180px;
      border: 3px solid var(--ink);
      border-top: none;
      border-radius: 0 0 8px 8px;
      background: rgba(255,255,255,0.5);
      display: flex; flex-direction: column-reverse;
      padding: 4px; gap: 4px;
    }
    .stack-bracket {
      width: 100%; height: 30px;
      background: var(--accent); color: white;
      display: grid; place-items: center;
      font-family: var(--mono); font-weight: bold;
      border-radius: 4px;
      animation: dropIn 0.2s;
    }

    /* Status Box */
    .parser-status {
      margin-top: 15px;
      padding: 10px;
      background: #1e293b; color: #f8fafc;
      font-family: var(--mono); font-size: 13px;
      border-radius: 6px;
      width: 100%;
      min-height: 40px;
      display: flex; align-items: center;
    }
    
    .result-badge {
      padding: 5px 10px; border-radius: 4px; font-weight: bold; text-transform: uppercase; font-size: 14px;
      display: none; margin-top: 10px;
    }
    .result-badge.success { display:inline-block; background: #dcfce7; color: #166534; border: 1px solid #86efac; }
    .result-badge.fail { display:inline-block; background: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; }

  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Algorithm</div><div class="sub">Compiler Syntax Checking</div></div>
    <span class="pill">Parsing</span>
  </div>

  <h2>Parsing: Balanced Parentheses</h2>

 <div class="grid-2">
  <div>
    <div style="font-size:16px; margin-bottom:15px;">
      Compilers use this logic to validate code syntax.
      <ul style="margin: 5px 0 15px 20px; font-size:15px; line-height:1.6;">
        <li><strong>Opening ( { [:</strong> Push to stack.</li>
        <li><strong>Closing ) } ]:</strong> Check if stack empty, then Pop & Match.</li>
      </ul>
    </div>
    
    <div class="code-block" style="height: 380px; overflow-y: auto; font-size:13px; font-family: 'Consolas', monospace; line-height: 1.6; white-space: pre;">
<span class="keyword">static bool</span> IsBalanced(<span class="keyword">string</span> s) {
  <span class="comment">// 1. Initialize Stack</span>
  Stack&lt;<span class="keyword">char</span>&gt; stack = <span class="keyword">new</span> Stack&lt;<span class="keyword">char</span>&gt;();

  <span class="keyword">foreach</span> (<span class="keyword">char</span> c <span class="keyword">in</span> s) {
    
    <span class="comment">// 2. Handle Opening Brackets (Push)</span>
    <span class="keyword">if</span> (c == <span class="string">'('</span> || c == <span class="string">'{'</span> || c == <span class="string">'['</span>) {
       stack.Push(c); 
    }

    <span class="comment">// 3. Handle Closing Brackets (Pop & Check)</span>
    <span class="keyword">else if</span> (c == <span class="string">')'</span> || c == <span class="string">'}'</span> || c == <span class="string">']'</span>) {
       
       <span class="comment">// Error: Stack is empty (nothing to close)</span>
       <span class="keyword">if</span> (stack.Count == 0) <span class="keyword">return false</span>;

       <span class="keyword">char</span> top = stack.Pop();

       <span class="comment">// Error: Mismatch detected</span>
       <span class="keyword">if</span> ( (c == <span class="string">')'</span> && top != <span class="string">'('</span>) ||
            (c == <span class="string">'}'</span> && top != <span class="string">'{'</span>) ||
            (c == <span class="string">']'</span> && top != <span class="string">'['</span>) ) {
          <span class="keyword">return false</span>;
       }
    }
  }

  <span class="comment">// 4. Final Check: Stack must be empty</span>
  <span class="keyword">return</span> stack.Count == 0;
}
    </div>
  </div>

  <div class="card" style="padding:15px; display:flex; flex-direction:column;">
    
    <div style="display:flex; gap:10px; margin-bottom:15px; align-items:center;">
        <select id="parse-select" style="padding:8px; border-radius:6px; border:1px solid var(--soft); flex-grow:1; font-family:monospace;">
            <option value="{([])}">Balanced: {([])}</option>
            <option value="[(])">Mismatch: [(])</option>
            <option value="((()">Missing Close: ((()</option>
            <option value="[{(A+B)}]">Complex: [{(A+B)}]</option>
            <option value="())">Empty Pop: ())</option>
        </select>
        <button class="mini-btn" onclick="startParse()" style="background:var(--accent); border-color:var(--accent); min-width:80px;">‚ñ∂ Run</button>
    </div>

    <div class="parser-stage" style="flex-grow:1;">
      <div class="tape-container" id="tape-view">
         <div style="padding:10px; color:#94a3b8; font-size:13px;">Select a string to start</div>
      </div>
      
      <div style="display:flex; gap:30px; width:100%; margin-top:10px;">
          <div style="display:flex; flex-direction:column; align-items:center;">
              <div style="font-size:12px; font-weight:bold; margin-bottom:5px; color:#64748b;">STACK</div>
              <div class="parser-stack" id="p-stack"></div>
          </div>
          
          <div style="flex-grow:1; display:flex; flex-direction:column; justify-content:center;">
               <div class="parser-status">
                  <span id="status-text" style="display:block; margin-bottom:5px;">&gt; Ready...</span>
               </div>
               <div id="parse-res-badge" class="result-badge"></div>
          </div>
      </div>
    </div>

  </div>
</div>
<div class="slide-footer"><div class="muted">Visualizing Syntax Validation</div><div class="slide-no" data-slide-no></div></div>
  <script>
    (function(){
      const tapeView = document.getElementById("tape-view");
      const stackView = document.getElementById("p-stack");
      const statusText = document.getElementById("status-text");
      const resBadge = document.getElementById("parse-res-badge");
      const selector = document.getElementById("parse-select");
      
      let isRunning = false;
      const PAIRS = { '(':')', '{':'}', '[':']' };
      const OPENS = ['(', '{', '['];

      window.startParse = function() {
        if(isRunning) return;
        isRunning = true;
        
        // Reset UI
        const inputStr = selector.value;
        tapeView.innerHTML = "";
        stackView.innerHTML = "";
        resBadge.style.display = "none";
        statusText.style.color = "#f8fafc";
        
        // Build Tape
        for(let char of inputStr) {
            tapeView.innerHTML += `<div class="tape-char">${char}</div>`;
        }
        const tapeChars = document.querySelectorAll(".tape-char");

        // Execution Loop (Visual Delay)
        let i = 0;
        let internalStack = [];
        
        function step() {
            if(i >= inputStr.length) {
                finish();
                return;
            }

            // Highlight current tape char
            if(i > 0) tapeChars[i-1].classList.remove('active');
            tapeChars[i].classList.add('active');
            
            const char = inputStr[i];
            
            // Ignore non-brackets (A, B, +, etc for complex example)
            if(!['(',')','{','}','[',']'].includes(char)) {
                statusText.innerText = `Skipping '${char}'...`;
                i++;
                setTimeout(step, 400);
                return;
            }

            if(OPENS.includes(char)) {
                // PUSH
                internalStack.push(char);
                const el = document.createElement("div");
                el.className = "stack-bracket";
                el.innerText = char;
                el.id = `st-${internalStack.length}`; // ID for tracking
                stackView.appendChild(el);
                
                statusText.innerText = `Found Open '${char}' -> PUSH`;
                i++;
                setTimeout(step, 800);
            } 
            else {
                // CLOSING
                statusText.innerText = `Found Close '${char}'... Checking Stack`;
                
                setTimeout(() => {
                    if(internalStack.length === 0) {
                        fail("Stack empty! No match found.");
                        return;
                    }
                    
                    const top = internalStack[internalStack.length - 1];
                    const expected = PAIRS[top];
                    
                    if(char === expected) {
                        // MATCH
                        internalStack.pop();
                        const stEl = stackView.lastElementChild;
                        stEl.style.background = "#22c55e"; // Flash Green
                        setTimeout(() => stEl.remove(), 300);
                        
                        statusText.innerText = `Matches '${top}' -> POP`;
                        i++;
                        setTimeout(step, 800);
                    } else {
                        // MISMATCH
                        fail(`Mismatch! Expected '${expected}' but found '${char}'`);
                    }
                }, 800);
            }
        }

        function finish() {
             if(tapeChars.length > 0) tapeChars[tapeChars.length-1].classList.remove('active');
             
             if(internalStack.length === 0) {
                 statusText.innerText = "Complete. Stack is empty.";
                 resBadge.className = "result-badge success";
                 resBadge.innerText = "BALANCED (TRUE)";
                 resBadge.style.display = "inline-block";
             } else {
                 fail("Incomplete! Stack not empty.");
             }
             isRunning = false;
        }

        function fail(reason) {
            statusText.innerText = reason;
            statusText.style.color = "#fca5a5";
            resBadge.className = "result-badge fail";
            resBadge.innerText = "NOT BALANCED (FALSE)";
            resBadge.style.display = "inline-block";
            isRunning = false;
        }

        step();
      };
    })();
  </script>
 

</section>
<section class="slide">
  <style>
    /* Maze Grid Styles */
    .maze-grid {
      display: grid;
      grid-template-columns: repeat(5, 40px);
      grid-template-rows: repeat(5, 40px);
      gap: 2px;
      margin-bottom: 10px;
    }
    .maze-cell {
      width: 40px; height: 40px;
      background: #e2e8f0;
      border-radius: 4px;
      display: flex; align-items: center; justify-content: center;
      font-size: 20px;
      transition: background 0.2s;
    }
    .maze-cell.wall { background: #475569; }
    .maze-cell.path { background: #86efac; } /* Green for active path */
    .maze-cell.backtracked { background: #fca5a5; } /* Red for dead ends */
    .rat { position: relative; z-index: 10; }
    
    /* Stack Visual for Maze */
    .maze-stack-view {
      height: 200px; width: 100px;
      border: 2px solid var(--ink); border-top: none;
      background: rgba(255,255,255,0.5);
      display: flex; flex-direction: column-reverse;
      padding: 5px; gap: 2px; overflow: hidden;
    }
    .coord-block {
      background: var(--accent); color: white;
      font-size: 11px; padding: 2px; text-align: center;
      font-family: var(--mono);
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Algorithms</div><div class="sub">Solving Problems</div></div>
    <span class="pill">Backtracking</span>
  </div>

  <h2>Rat in a Maze</h2>

  <div class="grid-2">
    <div>
      <p>Backtracking is a "goal seeking" strategy. If you reach a dead end, you return to the last decision point.</p>
      
      <div class="card" style="margin-top:15px; border-left: 5px solid var(--accent);">
        <h4 style="margin:0 0 10px 0;">How the Stack helps:</h4>
        <ol style="font-size:16px; line-height:1.6; padding-left:20px; margin:0;">
          <li><strong>Move Forward:</strong> <code>Push(Move)</code> onto the stack.</li>
          <li><strong>Dead End:</strong> <code>Pop()</code> the previous move (backtrack).</li>
          <li><strong>Retry:</strong> Search for alternative paths from the popped location.</li>
        </ol>
      </div>

      <div style="margin-top:20px;">
        <div style="font-size:14px; font-weight:bold; color:var(--muted); margin-bottom:5px;">STATUS:</div>
        <div id="maze-status" style="font-family:var(--mono); color:var(--ink); height:20px;">Ready to solve.</div>
        <button class="mini-btn" onclick="solveMaze()" style="margin-top:10px;">‚ñ∂ Start Simulation</button>
      </div>
    </div>

    <div class="card" style="display:flex; align-items:start; justify-content:center; gap:30px; padding:20px;">
      
      <div>
        <div style="font-size:12px; font-weight:bold; text-align:center; margin-bottom:5px;">MAZE (Start: 0,0)</div>
        <div class="maze-grid" id="maze-board">
            </div>
        <div style="font-size:12px; color:var(--muted); margin-top:5px;">
           <span style="color:#22c55e">‚óè</span> Path &nbsp; <span style="color:#f43f5e">‚óè</span> Dead End
        </div>
      </div>

      <div>
        <div style="font-size:12px; font-weight:bold; text-align:center; margin-bottom:5px;">PATH STACK</div>
        <div class="maze-stack-view" id="maze-stack-container"></div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Depth First Search (DFS) Visualization</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // 0=Open, 1=Wall, 9=Goal
      const mazeMap = [
        [0, 0, 1, 0, 0],
        [0, 1, 1, 0, 0],
        [0, 0, 0, 1, 0],
        [1, 1, 0, 0, 0],
        [0, 0, 0, 1, 9]
      ];
      
      const board = document.getElementById('maze-board');
      const stackView = document.getElementById('maze-stack-container');
      const status = document.getElementById('maze-status');
      let isSolving = false;

      // Init Grid
      function drawMaze() {
        board.innerHTML = "";
        stackView.innerHTML = "";
        for(let r=0; r<5; r++){
          for(let c=0; c<5; c++){
             const cell = document.createElement('div');
             cell.className = "maze-cell";
             cell.id = `cell-${r}-${c}`;
             if(mazeMap[r][c] === 1) cell.classList.add("wall");
             if(mazeMap[r][c] === 9) cell.innerText = "‚òÖ"; // Goal
             if(r===0 && c===0) cell.innerText = "üê≠";
             board.appendChild(cell);
          }
        }
      }
      drawMaze();

      // Async Sleep Helper
      const sleep = ms => new Promise(r => setTimeout(r, ms));

      window.solveMaze = async function() {
        if(isSolving) { drawMaze(); return; } // Reset if clicked again
        isSolving = true;
        drawMaze(); // Reset visual

        let pathStack = [];
        let visited = new Set();
        
        // Push Start
        pathStack.push([0,0]);
        updateStackVisual(pathStack);

        while(pathStack.length > 0) {
           let [r, c] = pathStack[pathStack.length-1]; // Peek
           const cellId = `cell-${r}-${c}`;
           
           // Highlight Current
           document.getElementById(cellId).innerText = "üê≠";
           document.getElementById(cellId).classList.add("path");
           
           // Check Goal
           if(mazeMap[r][c] === 9) {
               status.innerText = "GOAL REACHED!";
               status.style.color = "#16a34a";
               isSolving = false;
               return;
           }

           visited.add(`${r},${c}`);
           await sleep(400);

           // Find Neighbors (Right, Down, Left, Up)
           const dirs = [[0,1], [1,0], [0,-1], [-1,0]];
           let moved = false;

           for(let d of dirs) {
               let nr = r + d[0];
               let nc = c + d[1];
               
               // Check bounds, walls, and visited
               if(nr>=0 && nr<5 && nc>=0 && nc<5 && 
                  mazeMap[nr][nc] !== 1 && 
                  !visited.has(`${nr},${nc}`)) {
                   
                   pathStack.push([nr, nc]);
                   updateStackVisual(pathStack);
                   status.innerText = `Push(${nr}, ${nc})`;
                   document.getElementById(cellId).innerText = ""; // clear rat from old cell
                   moved = true;
                   break; // Depth First: take first valid path immediately
               }
           }

           if(!moved) {
               // Dead End -> Backtrack
               status.innerText = "Dead End! Backtracking...";
               status.style.color = "#ef4444";
               document.getElementById(cellId).innerText = "";
               document.getElementById(cellId).classList.remove("path");
               document.getElementById(cellId).classList.add("backtracked");
               
               pathStack.pop();
               updateStackVisual(pathStack);
               await sleep(400);
               status.style.color = "var(--ink)";
           }
        }
        status.innerText = "No path found.";
        isSolving = false;
      };

      function updateStackVisual(stack) {
        stackView.innerHTML = "";
        stack.forEach(pos => {
            let el = document.createElement("div");
            el.className = "coord-block";
            el.innerText = `[${pos[0]}, ${pos[1]}]`;
            stackView.appendChild(el);
        });
      }

    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Code Highlighting Styles */
    .code-wrapper {
      background: #1e293b;
      border-radius: 8px;
      padding: 15px;
      font-family: var(--mono);
      font-size: 13px;
      color: #cbd5e1;
      line-height: 1.5;
      position: relative;
      border: 1px solid #334155;
    }
    .c-line { display: block; padding: 0 4px; border-radius: 2px; transition: background 0.1s; }
    .c-line.active { background: #2563eb; color: white; font-weight: bold; }
    
    /* Maze Visuals */
    .debug-grid {
      display: grid;
      grid-template-columns: repeat(5, 50px);
      gap: 4px;
      margin-bottom: 20px;
    }
    .d-cell {
      width: 50px; height: 50px;
      background: #e2e8f0;
      border-radius: 6px;
      display: flex; align-items: center; justify-content: center;
      font-size: 24px;
      font-weight: bold;
      transition: all 0.3s;
      position: relative;
    }
    .d-cell.wall { background: #475569; }
    .d-cell.start { background: #93c5fd; }
    .d-cell.goal { background: #fcd34d; }
    
    /* Dynamic States */
    .d-cell.rat { background: #3b82f6; color: white; transform: scale(1.1); box-shadow: 0 0 15px rgba(59, 130, 246, 0.5); z-index: 2; }
    .d-cell.visited { background: #bbf7d0; } /* Light Green trail */
    .d-cell.backtracked { background: #fca5a5; opacity: 0.7; } /* Red dead path */

    /* Stack Column Visual */
    .debug-stack {
      width: 120px;
      height: 260px;
      border: 2px solid var(--ink);
      border-top: none;
      background: rgba(255,255,255,0.6);
      display: flex; flex-direction: column-reverse;
      padding: 5px; gap: 4px;
      overflow-y: auto;
    }
    .stack-frame-node {
      background: var(--accent); color: white;
      text-align: center; padding: 4px; border-radius: 4px;
      font-family: var(--mono); font-size: 12px;
      animation: slideInRight 0.2s;
    }
    @keyframes slideInRight { from { transform: translateX(20px); opacity:0; } to { transform: translateX(0); opacity:1; } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Deep Dive</div><div class="sub">Step-by-Step Debugging</div></div>
    <span class="pill">DFS Algorithm</span>
  </div>

  <h2>Rat in a Maze: The Code</h2>

  <div class="grid-2">
    <div>
      <div class="code-wrapper" id="maze-code">
        <div class="c-line" id="cl-1"><span class="keyword">void</span> SolveMaze() {</div>
        <div class="c-line" id="cl-2">  Stack&lt;Node&gt; s = <span class="keyword">new</span> Stack&lt;&gt;();</div>
        <div class="c-line" id="cl-3">  s.Push(StartNode);</div>
        <div class="c-line" id="cl-4">  <span class="keyword">while</span> (s.Count > 0) {</div>
        <div class="c-line" id="cl-5">    Node curr = s.Peek();</div>
        <div class="c-line" id="cl-6">    <span class="keyword">if</span> (curr == Goal) <span class="keyword">return true</span>;</div>
        <br>
        <div class="c-line" id="cl-7">    <span class="keyword">if</span> (GetUnvisitedNeighbor(curr)) {</div>
        <div class="c-line" id="cl-8">       s.Push(neighbor); <span class="comment">// Move</span></div>
        <div class="c-line" id="cl-9">    } <span class="keyword">else</span> {</div>
        <div class="c-line" id="cl-10">       s.Pop(); <span class="comment">// Backtrack</span></div>
        <div class="c-line" id="cl-11">    }</div>
        <div class="c-line" id="cl-12">  }</div>
        <div class="c-line" id="cl-13">}</div>
      </div>

      <div class="callout" style="display:flex; flex-direction:column; gap:10px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
           <div style="font-weight:bold; font-size:14px;">DEBUG CONTROLS</div>
           <div id="debug-status" style="font-family:var(--mono); font-size:12px; color:var(--accent);">Ready</div>
        </div>
        <div style="display:flex; gap:10px;">
           <button class="mini-btn" onclick="startDebug()" style="background:#2563eb; border-color:#2563eb;">‚ñ∂ Start Debugging</button>
           <button class="mini-btn" onclick="resetDebug()">‚Ü∫ Reset</button>
        </div>
      </div>
    </div>

    <div class="card" style="display:flex; gap:20px; align-items:flex-start; justify-content:center; padding:25px;">
      
      <div>
        <div style="font-size:12px; font-weight:bold; text-align:center; margin-bottom:10px;">GAME BOARD</div>
        <div class="debug-grid" id="d-grid">
           </div>
        <div style="font-size:12px; color:var(--muted); margin-top:10px; text-align:center;">
            Start: (0,0) &nbsp; Goal: (4,4)
        </div>
      </div>

      <div>
         <div style="font-size:12px; font-weight:bold; text-align:center; margin-bottom:10px;">STACK MEMORY</div>
         <div class="debug-stack" id="d-stack">
            </div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Live Code Execution</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // 0=Path, 1=Wall, 9=Goal
      const map = [
        [0, 1, 0, 0, 0],
        [0, 1, 0, 1, 0],
        [0, 0, 0, 1, 0],
        [0, 1, 1, 1, 0],
        [0, 0, 0, 0, 9]
      ];
      
      const gridBox = document.getElementById('d-grid');
      const stackBox = document.getElementById('d-stack');
      const statusLbl = document.getElementById('debug-status');
      let isDebugging = false;

      // 1. Initialize Grid
      function initGrid() {
        gridBox.innerHTML = "";
        stackBox.innerHTML = "";
        for(let r=0; r<5; r++){
          for(let c=0; c<5; c++){
             const d = document.createElement('div');
             d.className = "d-cell";
             d.id = `d-${r}-${c}`;
             if(map[r][c] === 1) d.classList.add('wall');
             if(map[r][c] === 9) { d.innerText = "‚òÖ"; d.classList.add('goal'); }
             if(r===0 && c===0) { d.classList.add('start'); d.innerText="üê≠"; }
             gridBox.appendChild(d);
          }
        }
      }
      initGrid();

      // Helper: Highlight Code Line
      function hl(id) {
        document.querySelectorAll('.c-line').forEach(el => el.classList.remove('active'));
        const line = document.getElementById(id);
        if(line) line.classList.add('active');
      }

      // Helper: Sync Stack Visual
      function renderStack(stack) {
        stackBox.innerHTML = "";
        stack.forEach(node => {
           const div = document.createElement("div");
           div.className = "stack-frame-node";
           div.innerText = `Node(${node.r},${node.c})`;
           stackBox.appendChild(div);
        });
      }

      const sleep = ms => new Promise(r => setTimeout(r, ms));

      // 2. The Algo
      window.startDebug = async function() {
        if(isDebugging) return;
        isDebugging = true;
        initGrid(); // Clear previous run
        
        let stack = [];
        let visited = new Set();
        
        // --- LINE 2 & 3: Init ---
        hl('cl-2'); statusLbl.innerText = "Init Stack..."; await sleep(600);
        
        hl('cl-3'); 
        statusLbl.innerText = "Push Start(0,0)";
        stack.push({r:0, c:0});
        renderStack(stack);
        await sleep(800);

        // --- LINE 4: While Loop ---
        while(stack.length > 0) {
           hl('cl-4'); await sleep(300);

           // --- LINE 5: Peek ---
           let curr = stack[stack.length-1]; // Peek
           hl('cl-5'); 
           statusLbl.innerText = `Peek: (${curr.r},${curr.c})`;
           
           // Update Grid Rat Position
           document.querySelectorAll('.rat').forEach(e => e.classList.remove('rat'));
           const cell = document.getElementById(`d-${curr.r}-${curr.c}`);
           cell.classList.add('rat');
           cell.innerText = "üê≠";
           
           if(!cell.classList.contains('visited')) {
               cell.classList.add('visited'); // Mark as part of current path trail
           }
           await sleep(800);

           // --- LINE 6: Check Goal ---
           hl('cl-6');
           if(map[curr.r][curr.c] === 9) {
               statusLbl.innerText = "GOAL FOUND!";
               statusLbl.style.color = "#16a34a";
               cell.style.background = "#22c55e"; // Bright Green
               isDebugging = false;
               return;
           }
           await sleep(300);

           // --- LINE 7: Check Neighbors ---
           hl('cl-7');
           visited.add(`${curr.r},${curr.c}`);
           
           // Logic to find ONE valid neighbor (Right, Down, Left, Up)
           const dirs = [[0,1], [1,0], [0,-1], [-1,0]];
           let found = null;
           
           for(let d of dirs) {
               let nr = curr.r + d[0];
               let nc = curr.c + d[1];
               // Bounds check + Wall Check + Visited Check
               if(nr>=0 && nr<5 && nc>=0 && nc<5 && map[nr][nc]!==1 && !visited.has(`${nr},${nc}`)) {
                   found = {r:nr, c:nc};
                   break;
               }
           }
           
           await sleep(600);

           if(found) {
               // --- LINE 8: PUSH (Move) ---
               hl('cl-8');
               statusLbl.innerText = `Found Neighbor -> Push(${found.r},${found.c})`;
               
               // Remove rat icon from current before moving (leave breadcrumb)
               cell.innerText = ""; 
               
               stack.push(found);
               renderStack(stack);
           } else {
               // --- LINE 9/10: POP (Backtrack) ---
               hl('cl-9'); await sleep(300);
               hl('cl-10');
               statusLbl.innerText = "Dead End -> Pop()";
               statusLbl.style.color = "#ef4444";
               
               // Visual: Mark dead end
               cell.classList.add('backtracked');
               cell.classList.remove('rat');
               cell.innerText = "";
               
               stack.pop();
               renderStack(stack);
               
               // Move Rat visual back to previous (new top)
               if(stack.length > 0) {
                   let prev = stack[stack.length-1];
                   let prevCell = document.getElementById(`d-${prev.r}-${prev.c}`);
                   prevCell.classList.add('rat');
                   prevCell.innerText = "üê≠";
               }
               
               setTimeout(() => statusLbl.style.color = "var(--accent)", 800);
           }
           await sleep(1000);
        }
        
        statusLbl.innerText = "Stack Empty. No Path.";
        isDebugging = false;
      };

      window.resetDebug = function() {
        isDebugging = false;
        initGrid();
        document.querySelectorAll('.c-line').forEach(el => el.classList.remove('active'));
        statusLbl.innerText = "Ready";
      }

    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Layout */
    .callstack-stage {
      display: flex;
      gap: 30px;
      padding: 20px;
      align-items: flex-start;
      justify-content: center;
      height: 100%;
    }

    /* Left: Code Viewer */
    .cs-code-box {
      background: #1e293b;
      color: #cbd5e1;
      padding: 20px;
      border-radius: 12px;
      font-family: var(--mono);
      font-size: 14px;
      line-height: 1.6;
      width: 300px;
      border: 1px solid #334155;
      position: relative;
    }
    .cs-line {
      padding: 0 8px; border-radius: 4px; display: block;
      transition: background 0.2s;
    }
    .cs-line.active-line {
      background: #3b82f6; color: white; font-weight: bold;
    }

    /* Right: Stack Container */
    .cs-stack-container {
      width: 220px;
      height: 380px;
      border-left: 4px solid var(--ink);
      border-right: 4px solid var(--ink);
      border-bottom: 4px solid var(--ink);
      background: rgba(241, 245, 249, 0.5);
      border-radius: 0 0 12px 12px;
      display: flex;
      flex-direction: column-reverse; /* Stacks grow up */
      padding: 10px;
      gap: 5px;
      position: relative;
    }
    
    .cs-stack-container::after {
      content: "MEMORY STACK";
      position: absolute; bottom: -30px; width: 100%; text-align: center;
      font-weight: bold; color: var(--muted); font-size: 12px;
    }

    /* Stack Frames */
    .stack-frame {
      background: white;
      border: 2px solid var(--ink);
      border-radius: 8px;
      padding: 10px;
      text-align: center;
      font-family: var(--sans);
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      animation: slideDownFrame 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      position: relative;
      overflow: hidden;
    }
    
    /* Frame Colors */
    .frame-main { border-color: #64748b; background: #f1f5f9; }
    .frame-a { border-color: #3b82f6; background: #eff6ff; }
    .frame-b { border-color: #eab308; background: #fefce8; }
    
    .frame-title { font-weight: 800; font-size: 14px; margin-bottom: 4px; }
    .frame-meta { font-size: 11px; color: var(--muted); font-family: var(--mono); }

    /* Animation Classes */
    .stack-frame.popping {
      animation: popOutFrame 0.4s ease forwards;
    }

    @keyframes slideDownFrame {
      from { transform: translateY(-30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes popOutFrame {
      to { transform: scale(0.9) translateY(-20px); opacity: 0; }
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Execution Tracking</div><div class="sub">The Call Stack</div></div>
    <span class="pill">Function Calls</span>
  </div>

  <h2>Tracking Function Calls</h2>

  <div class="callstack-stage">
    
    <div>
      <div style="font-weight:bold; margin-bottom:10px; color:var(--muted);">SOURCE CODE</div>
      <div class="cs-code-box">
        <div class="cs-line" id="csl-1"><span class="keyword">void</span> Main() {</div>
        <div class="cs-line" id="csl-2">  <span class="keyword">int</span> x = 10;</div>
        <div class="cs-line" id="csl-3">  <span class="method">FunctionA</span>(x);</div>
        <div class="cs-line" id="csl-4">  print(<span class="string">"Done"</span>);</div>
        <div class="cs-line" id="csl-5">}</div>
        <br>
        <div class="cs-line" id="csl-6"><span class="keyword">void</span> FunctionA(<span class="keyword">int</span> val) {</div>
        <div class="cs-line" id="csl-7">  val = val + 5;</div>
        <div class="cs-line" id="csl-8">  <span class="method">FunctionB</span>(val);</div>
        <div class="cs-line" id="csl-9">}</div>
        <br>
        <div class="cs-line" id="csl-10"><span class="keyword">void</span> FunctionB(<span class="keyword">int</span> v) {</div>
        <div class="cs-line" id="csl-11">  print(v * 2);</div>
        <div class="cs-line" id="csl-12">  <span class="keyword">return</span>;</div>
        <div class="cs-line" id="csl-13">}</div>
      </div>

      <div class="callout" style="margin-top:20px; display:flex; flex-direction:column; gap:10px;">
        <div id="cs-status" style="font-weight:bold; color:var(--ink);">Ready to start.</div>
        <div style="display:flex; gap:10px;">
           <button class="mini-btn" onclick="stepCallStack()" style="background:var(--accent); border-color:var(--accent); width:120px;">Step Into ‚§µ</button>
           <button class="mini-btn" onclick="resetCallStack()" style="width:80px;">Reset</button>
        </div>
      </div>
    </div>

    <div>
       <div style="font-weight:bold; margin-bottom:10px; color:var(--muted); text-align:center;">STACK VISUALIZATION</div>
       <div class="cs-stack-container" id="cs-stack">
          </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing Nested Calls</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const stackContainer = document.getElementById("cs-stack");
      const status = document.getElementById("cs-status");
      let stepIndex = 0;

      // Highlight Helper
      function hlCode(lineIds) {
        document.querySelectorAll('.cs-line').forEach(l => l.classList.remove('active-line'));
        lineIds.forEach(id => {
            const el = document.getElementById(id);
            if(el) el.classList.add('active-line');
        });
      }

      // Stack Helper
      function pushFrame(name, vars, type) {
        const frame = document.createElement("div");
        frame.className = `stack-frame frame-${type}`;
        frame.innerHTML = `
            <div class="frame-title">${name}()</div>
            <div class="frame-meta">${vars}</div>
        `;
        stackContainer.appendChild(frame);
      }

      function popFrame() {
        if(stackContainer.children.length > 0) {
            const frame = stackContainer.lastElementChild;
            frame.classList.add("popping");
            setTimeout(() => frame.remove(), 400);
        }
      }

      window.stepCallStack = function() {
        stepIndex++;

        switch(stepIndex) {
            case 1:
                hlCode(['csl-1', 'csl-2']);
                pushFrame("Main", "x = 10", "main");
                status.innerText = "Main() starts. Pushed to Stack.";
                break;
            case 2:
                hlCode(['csl-3']);
                status.innerText = "Main calls FunctionA...";
                break;
            case 3:
                hlCode(['csl-6', 'csl-7']);
                pushFrame("FunctionA", "val = 15", "a");
                status.innerText = "FunctionA() starts. Pausing Main.";
                break;
            case 4:
                hlCode(['csl-8']);
                status.innerText = "FunctionA calls FunctionB...";
                break;
            case 5:
                hlCode(['csl-10', 'csl-11']);
                pushFrame("FunctionB", "v = 15", "b");
                status.innerText = "FunctionB() starts. Pausing A.";
                break;
            case 6:
                hlCode(['csl-12']);
                status.innerText = "FunctionB hits return.";
                break;
            case 7:
                hlCode(['csl-8']); // Back to A
                popFrame();
                status.innerText = "FunctionB Popped. Resuming FunctionA.";
                break;
            case 8:
                hlCode(['csl-9']); // End of A
                status.innerText = "FunctionA finishes.";
                break;
            case 9:
                hlCode(['csl-3']); // Back to Main
                popFrame();
                status.innerText = "FunctionA Popped. Resuming Main.";
                break;
            case 10:
                hlCode(['csl-4']);
                status.innerText = "Main prints 'Done'.";
                break;
            case 11:
                hlCode(['csl-5']);
                popFrame();
                status.innerText = "Main finishes. Stack Empty.";
                break;
            default:
                status.innerText = "Program Finished.";
                break;
        }
      };

      window.resetCallStack = function() {
        stepIndex = 0;
        stackContainer.innerHTML = "";
        document.querySelectorAll('.cs-line').forEach(l => l.classList.remove('active-line'));
        status.innerText = "Ready to start.";
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Explorer Window Frame */
    .explorer-window {
      width: 100%;
      height: 500px;
      background: #f8fafc;
      border: 1px solid var(--soft);
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    /* Top Bar (Address & Nav) */
    .explorer-bar {
      background: white;
      border-bottom: 1px solid var(--soft);
      padding: 12px 20px;
      display: flex;
      gap: 15px;
      align-items: center;
    }

    /* Nav Buttons */
    .nav-btn {
      width: 36px; height: 36px;
      border-radius: 50%;
      border: 1px solid var(--soft);
      background: white;
      color: var(--ink);
      display: grid; place-items: center;
      cursor: pointer;
      transition: all 0.2s;
    }
    .nav-btn:hover:not(:disabled) { background: #f1f5f9; transform: scale(1.05); }
    .nav-btn:disabled { opacity: 0.3; cursor: not-allowed; transform: none; }
    .nav-icon { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 3; stroke-linecap: round; stroke-linejoin: round; }

    /* Address Bar */
    .address-input {
      flex-grow: 1;
      background: #f1f5f9;
      border: 1px solid var(--soft);
      border-radius: 6px;
      padding: 8px 12px;
      font-family: var(--mono);
      font-size: 14px;
      color: var(--muted);
    }

    /* Main Content Layout */
    .explorer-body {
      flex-grow: 1;
      display: grid;
      grid-template-columns: 140px 1fr 140px; /* Stacks on sides, content middle */
      padding: 20px;
      gap: 20px;
      background: #f8fafc;
    }

    /* The Stacks Visuals */
    .stack-col {
      display: flex; flex-direction: column;
      align-items: center;
      border: 2px dashed var(--soft);
      border-radius: 8px;
      padding: 10px;
      background: rgba(255,255,255,0.5);
    }
    .stack-col h4 { margin: 0 0 10px 0; font-size: 12px; color: var(--muted); text-transform: uppercase; }
    
    .stack-list {
      width: 100%;
      display: flex; flex-direction: column-reverse; /* Bottom up */
      gap: 5px;
      flex-grow: 1;
      justify-content: flex-start;
    }

    .hist-item {
      background: white;
      border: 1px solid var(--soft);
      padding: 6px;
      font-size: 11px;
      font-family: var(--mono);
      text-align: center;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      animation: slideInStack 0.3s ease;
    }

    /* Center Content (Folders) */
    .folder-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      grid-auto-rows: 100px;
      gap: 15px;
      align-content: start;
    }
    .folder {
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      background: white;
      border: 1px solid transparent;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .folder:hover { background: #e0f2fe; border-color: #3b82f6; }
    .folder-icon { font-size: 40px; margin-bottom: 5px; }
    .folder-name { font-size: 13px; font-weight: bold; color: var(--ink); text-align: center; }

    @keyframes slideInStack { from{opacity:0; transform:translateY(10px);} to{opacity:1; transform:translateY(0);} }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Real World</div><div class="sub">Two-Stack Algorithm</div></div>
    <span class="pill">Back / Forward</span>
  </div>

  <h2>Application: File Explorer History</h2>

  <div class="explorer-window">
    
    <div class="explorer-bar">
      <button class="nav-btn" id="btn-back" onclick="navBack()" title="Back" disabled>
        <svg class="nav-icon" viewBox="0 0 24 24"><path d="M19 12H5M12 19l-7-7 7-7"/></svg>
      </button>
      <button class="nav-btn" id="btn-fwd" onclick="navForward()" title="Forward" disabled>
        <svg class="nav-icon" viewBox="0 0 24 24"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
      </button>
      <div class="nav-btn" title="Up" onclick="navUp()">
         <svg class="nav-icon" viewBox="0 0 24 24"><path d="M12 19V5M5 12l7-7 7 7"/></svg>
      </div>
      
      <div class="address-input" id="addr-bar">C:/Users/Student</div>
    </div>

    <div class="explorer-body">
      
      <div class="stack-col">
        <h4>Back Stack</h4>
        <div class="stack-list" id="stack-back-vis">
          </div>
      </div>

      <div style="position:relative;">
        <div class="folder-grid" id="folder-view">
           </div>
        
        <div style="position:absolute; bottom:0; left:0; right:0; background:rgba(255,255,255,0.9); padding:10px; font-size:13px; border-top:1px solid var(--soft); color:var(--muted);">
           <strong>Logic:</strong>
           <ul style="margin:5px 0 0 15px; padding:0;">
             <li><strong>Visit New:</strong> Push current to Back Stack. Clear Forward Stack.</li>
             <li><strong>Click Back:</strong> Pop Back Stack. Push current to Forward Stack.</li>
           </ul>
        </div>
      </div>

      <div class="stack-col">
        <h4>Forward Stack</h4>
        <div class="stack-list" id="stack-fwd-vis">
          </div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Navigation History Logic</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // STATE
      let currentPath = "C:/Users/Student";
      let backStack = [];
      let fwdStack = [];

      // MOCK FILE SYSTEM
      const fileSystem = {
        "C:/Users/Student": [
            {name: "Documents", type: "folder"},
            {name: "Pictures", type: "folder"},
            {name: "Downloads", type: "folder"},
            {name: "Desktop", type: "folder"}
        ],
        "C:/Users/Student/Documents": [
            {name: "School", type: "folder"},
            {name: "Resume.pdf", type: "file"},
            {name: "Notes.txt", type: "file"}
        ],
        "C:/Users/Student/Pictures": [
            {name: "Vacation", type: "folder"},
            {name: "Meme.png", type: "file"}
        ],
        "C:/Users/Student/Downloads": [
            {name: "Installer.exe", type: "file"}
        ],
        "C:/Users/Student/Desktop": [],
        "C:/Users/Student/Documents/School": [
            {name: "COIS2020", type: "folder"}
        ],
        "C:/Users/Student/Pictures/Vacation": []
      };

      // UI REFS
      const addrBar = document.getElementById('addr-bar');
      const folderView = document.getElementById('folder-view');
      const backVis = document.getElementById('stack-back-vis');
      const fwdVis = document.getElementById('stack-fwd-vis');
      const btnBack = document.getElementById('btn-back');
      const btnFwd = document.getElementById('btn-fwd');

      // 1. RENDER FOLDER CONTENT
      function renderFolder() {
        addrBar.innerText = currentPath;
        folderView.innerHTML = "";
        
        const contents = fileSystem[currentPath] || [];
        
        if(contents.length === 0) {
            folderView.innerHTML = "<div style='grid-column:1/-1; text-align:center; color:#cbd5e1; margin-top:50px;'>Empty Folder</div>";
        }

        contents.forEach(item => {
            const el = document.createElement('div');
            el.className = 'folder';
            const icon = item.type === 'folder' ? 'üìÅ' : 'üìÑ';
            el.innerHTML = `<div class="folder-icon">${icon}</div><div class="folder-name">${item.name}</div>`;
            
            if(item.type === 'folder') {
                el.onclick = () => visitFolder(item.name);
            }
            folderView.appendChild(el);
        });

        renderStacks();
        updateButtons();
      }

      // 2. RENDER STACKS VISUAL
      function renderStacks() {
        // Back Stack
        backVis.innerHTML = "";
        backStack.forEach(path => {
            let shortName = path.split('/').pop() || path;
            backVis.innerHTML += `<div class="hist-item">${shortName}</div>`;
        });

        // Fwd Stack
        fwdVis.innerHTML = "";
        fwdStack.forEach(path => {
            let shortName = path.split('/').pop() || path;
            fwdVis.innerHTML += `<div class="hist-item">${shortName}</div>`;
        });
      }

      function updateButtons() {
          btnBack.disabled = backStack.length === 0;
          btnFwd.disabled = fwdStack.length === 0;
      }

      // 3. ACTIONS
      
      // A. VISIT NEW
      window.visitFolder = function(folderName) {
        // 1. Push OLD path to Back Stack
        backStack.push(currentPath);
        
        // 2. Clear Forward Stack (Browser rule: new path destroys future history)
        fwdStack = [];
        
        // 3. Update Current
        currentPath = currentPath === "C:/" ? `C:/${folderName}` : `${currentPath}/${folderName}`;
        
        renderFolder();
      };

      // B. GO BACK
      window.navBack = function() {
        if(backStack.length === 0) return;

        // 1. Push CURRENT to Forward Stack
        fwdStack.push(currentPath);

        // 2. Pop from Back Stack and make it Current
        currentPath = backStack.pop();

        renderFolder();
      };

      // C. GO FORWARD
      window.navForward = function() {
        if(fwdStack.length === 0) return;

        // 1. Push CURRENT to Back Stack
        backStack.push(currentPath);

        // 2. Pop from Forward Stack and make it Current
        currentPath = fwdStack.pop();

        renderFolder();
      };

      // D. GO UP (Helper)
      window.navUp = function() {
          const parts = currentPath.split('/');
          if(parts.length <= 1) return; // Root
          
          // Treat 'Up' like visiting a new folder for simplicity in stack logic
          // Or strictly navigating. Let's treat it as a visit to parent.
          const parent = parts.slice(0, -1).join('/');
          if(fileSystem[parent] !== undefined) {
              // Standard visit logic
              backStack.push(currentPath);
              fwdStack = [];
              currentPath = parent;
              renderFolder();
          }
      };

      // INIT
      renderFolder();

    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Queue Container */
    .queue-array-box {
      display: flex;
      gap: 15px;
      padding: 30px;
      background: #f1f5f9;
      border: 2px solid var(--soft);
      border-radius: 12px;
      justify-content: center;
      margin-top: 40px;
      position: relative;
    }

    /* Array Slot */
    .q-slot {
      width: 70px; height: 70px;
      background: white;
      border: 2px solid var(--ink);
      border-radius: 8px;
      display: grid; place-items: center;
      font-family: var(--mono); font-weight: bold; font-size: 20px;
      position: relative;
    }
    .q-slot.filled { background: var(--accent); color: white; border-color: #14532d; }
    .q-slot.empty { color: var(--soft); border-style: dashed; }

    /* Index Labels */
    .q-idx {
      position: absolute; bottom: -25px;
      font-size: 12px; color: var(--muted); font-family: var(--mono);
    }

    /* Pointers */
    .ptr-label {
      position: absolute; top: -35px;
      font-size: 14px; font-weight: 900;
      transition: all 0.3s ease;
      white-space: nowrap;
    }
    .ptr-head { color: #ef4444; } /* Red for Head (Remove) */
    .ptr-tail { color: #2563eb; } /* Blue for Tail (Add) */
    
    .ptr-label::after {
      content: "‚Üì"; display: block; text-align: center; font-size: 20px; line-height: 1;
    }

    /* Direction Toggle */
    .toggle-wrap {
      display: flex; align-items: center; gap: 10px; margin-bottom: 20px;
      background: #fff; padding: 10px; border-radius: 8px; border: 1px solid var(--soft);
      font-size: 14px; width: fit-content;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Linear Structure</div><div class="sub">First-In, First-Out</div></div>
    <span class="pill">Array Implementation</span>
  </div>

  <h2>Queue: Array Presentation</h2>

  <div class="grid-2">
    <div>
      <p>A Queue uses two pointers to manage data in an array.</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">Standard Operations:</h4>
        <ul style="line-height:1.8;">
          <li><strong>Enqueue (Add):</strong> Insert at <code>Tail</code>, then <code>Tail++</code>.</li>
          <li><strong>Dequeue (Remove):</strong> Remove at <code>Head</code>, then <code>Head++</code>.</li>
        </ul>
      </div>

      <div class="callout" style="border-left-color:#8b5cf6;">
        <strong>Can we reverse it?</strong><br>
        Yes! You can add to Head and remove from Tail.
        <br><span style="font-size:0.9em; color:var(--muted);">It doesn't matter mathematically, as long as opposite ends are used (FIFO). Convention usually dictates Tail for entry.</span>
      </div>

      <div style="margin-top:20px; display:flex; gap:10px;">
        <button class="mini-btn" onclick="qEnqueue()" style="background:#2563eb; border-color:#2563eb;">+ Enqueue</button>
        <button class="mini-btn" onclick="qDequeue()" style="background:#ef4444; border-color:#ef4444;">- Dequeue</button>
        <button class="mini-btn" onclick="qReset()" style="background:#64748b; border-color:#64748b;">Reset</button>
      </div>
    </div>

    <div class="card" style="padding:20px; overflow:visible;">
      
      <div style="text-align:center; font-weight:bold; color:var(--muted); margin-bottom:10px;">MEMORY VISUALIZATION</div>
      
      <div style="position:relative; height:40px; margin-top:20px;">
         <div id="ptr-head" class="ptr-label ptr-head" style="left: 45px;">HEAD</div>
         <div id="ptr-tail" class="ptr-label ptr-tail" style="left: 45px;">TAIL</div>
      </div>

      <div class="queue-array-box" id="q-container">
        <div class="q-slot empty"><div class="q-idx">0</div></div>
        <div class="q-slot empty"><div class="q-idx">1</div></div>
        <div class="q-slot empty"><div class="q-idx">2</div></div>
        <div class="q-slot empty"><div class="q-idx">3</div></div>
        <div class="q-slot empty"><div class="q-idx">4</div></div>
      </div>

      <div style="text-align:center; font-size:13px; color:var(--muted); margin-top:20px;">
        Notice: As you Dequeue, the <code>Head</code> moves right.<br>
        (This creates dead space at the start!)
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing Pointers</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const headPtr = document.getElementById("ptr-head");
      const tailPtr = document.getElementById("ptr-tail");
      const slots = document.querySelectorAll(".q-slot");
      
      let head = 0;
      let tail = 0;
      const MAX = 5;

      // Layout Constants
      const START_X = 65; 
      const STEP_X = 85;

      function updatePointers() {
        headPtr.style.left = (START_X + (head * STEP_X) - 20) + "px";
        tailPtr.style.left = (START_X + (tail * STEP_X) - 20) + "px";
        
        if(head === tail) {
            headPtr.style.transform = "translateY(-20px)";
        } else {
            headPtr.style.transform = "translateY(0)";
        }
      }

      window.qEnqueue = function() {
        if(tail >= MAX) { alert("Queue Full (at Tail)!"); return; }
        
        const val = Math.floor(Math.random() * 90 + 10);
        
        // Update Slot
        const slot = slots[tail];
        slot.className = "q-slot filled";
        slot.innerText = val;
        
        // Move Tail
        tail++;
        updatePointers();
      };

      window.qDequeue = function() {
        if(head === tail) { alert("Queue Empty!"); return; }
        
        // Clear Slot
        const slot = slots[head];
        slot.className = "q-slot empty";
        slot.innerText = ""; // Note: This removes the index label
        
        // Move Head
        head++;
        updatePointers();
      };

      // NEW RESET FUNCTION
      window.qReset = function() {
        head = 0;
        tail = 0;
        
        slots.forEach((slot, index) => {
          slot.className = "q-slot empty";
          // We manually put the index div back because innerText="" removed it
          slot.innerHTML = `<div class="q-idx">${index}</div>`; 
        });
        
        updatePointers();
      };

      // Init
      updatePointers();

    })();
  </script>
</section>
<section class="slide">
  <style>
    /* The Ring Container */
    .circular-stage {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 400px;
      position: relative;
    }

    .circle-container {
      width: 300px; height: 300px;
      position: relative;
      border: 2px dashed var(--soft);
      border-radius: 50%;
      /* Helper guide for the ring shape */
    }

    /* Individual Slots positioned radially */
    .c-slot {
      width: 60px; height: 60px;
      position: absolute;
      top: 50%; left: 50%;
      margin-top: -30px; margin-left: -30px; /* Center anchor */
      background: white;
      border: 2px solid var(--ink);
      border-radius: 50%;
      display: grid; place-items: center;
      font-weight: bold; font-family: var(--mono);
      transition: all 0.3s;
      z-index: 2;
    }
    .c-slot.filled { background: var(--accent); color: white; border-color: #14532d; }
    
    /* Index Markers */
    .c-idx {
      position: absolute; top: -20px;
      font-size: 12px; color: var(--muted); font-weight: normal;
    }

    /* Pointers (Orbiting labels) */
    .orbit-ptr {
      position: absolute;
      width: 60px; height: 60px;
      top: 50%; left: 50%;
      margin-top: -30px; margin-left: -30px;
      pointer-events: none;
      transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      z-index: 5;
    }
    
    .ptr-tag {
      position: absolute;
      font-weight: 900; font-size: 14px;
      padding: 4px 8px; border-radius: 4px;
      color: white;
      top: -45px; left: 10px; /* Offset from the slot */
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
    }
    .tag-head { background: #ef4444; }
    .tag-tail { background: #2563eb; }

    /* Center Info */
    .center-info {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      font-family: var(--mono);
      font-size: 12px; color: var(--muted);
      width: 120px;
    }

    /* Formula Badge */
    .formula-badge {
      background: #1e293b; color: #f1f5f9;
      padding: 8px 12px; border-radius: 8px;
      font-family: var(--mono); font-size: 14px;
      display: inline-block; margin-top: 10px;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Optimization</div><div class="sub">Memory Efficiency</div></div>
    <span class="pill">Circular Queue</span>
  </div>

  <h2>Circular Array Implementation</h2>

  <div class="grid-2">
    <div>
      <p>In a standard array, moving the pointers creates "dead space" at the beginning.</p>
      
      <div class="card" style="margin-top:20px; border-left: 5px solid #8b5cf6;">
        <h3 style="margin:0 0 10px 0; font-size:20px;">The Trick: Wrap Around</h3>
        <p style="font-size:16px;">We theoretically connect the last index to the first using the <strong>Modulo Operator (%)</strong>.</p>
        
        <div style="margin: 15px 0;">
          <div style="font-size:12px; color:var(--muted); font-weight:bold;">NEXT POSITION FORMULA:</div>
          <div class="formula-badge">
             (Index + 1) % Size
          </div>
        </div>

        <p style="font-size:14px; color:var(--muted);">
          Example: If Size is 8 and we are at Index 7:<br>
          <code>(7 + 1) % 8 = 0</code> <br>(Back to start!)
        </p>
      </div>

      <div style="margin-top:20px; display:flex; gap:10px;">
        <button class="mini-btn" onclick="circEnqueue()" style="background:#2563eb; border-color:#2563eb;">+ Enqueue</button>
        <button class="mini-btn" onclick="circDequeue()" style="background:#ef4444; border-color:#ef4444;">- Dequeue</button>
      </div>
    </div>

    <div class="card" style="padding:0;">
       <div class="circular-stage">
          
          <div class="circle-container" id="ring-stage">
             <div class="center-info">
                <strong>Capacity: 8</strong><br>
                <span id="count-lbl">Count: 0</span>
             </div>

             <div id="ring-head" class="orbit-ptr"><div class="ptr-tag tag-head">HEAD</div></div>
             <div id="ring-tail" class="orbit-ptr"><div class="ptr-tag tag-tail">TAIL</div></div>
          </div>

       </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing Modulo Arithmetic</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const ringStage = document.getElementById('ring-stage');
      const pHead = document.getElementById('ring-head');
      const pTail = document.getElementById('ring-tail');
      const countLbl = document.getElementById('count-lbl');

      const SIZE = 8;
      const RADIUS = 120; // px
      let buffer = new Array(SIZE).fill(null);
      let head = 0;
      let tail = 0;
      let count = 0;

      // 1. Build the Ring
      function initRing() {
        // Clear existing slots (keep the pointers/info which are static div children)
        const slots = ringStage.querySelectorAll('.c-slot');
        slots.forEach(s => s.remove());

        for(let i=0; i<SIZE; i++) {
           const slot = document.createElement('div');
           slot.className = 'c-slot';
           slot.id = `ring-slot-${i}`;
           slot.innerHTML = `<span class="c-idx">${i}</span><span class="val"></span>`;
           
           // Calculate Position
           const angle = (360 / SIZE) * i - 90; // -90 to start at top
           const rad = angle * (Math.PI / 180);
           const x = Math.cos(rad) * RADIUS;
           const y = Math.sin(rad) * RADIUS;
           
           slot.style.transform = `translate(${x}px, ${y}px)`;
           ringStage.appendChild(slot);
        }
        updateVisuals();
      }

      // 2. Visual Updater
      function updateVisuals() {
         // Update Slots
         for(let i=0; i<SIZE; i++) {
             const slot = document.getElementById(`ring-slot-${i}`);
             const valSpan = slot.querySelector('.val');
             
             if(buffer[i] !== null) {
                 slot.classList.add('filled');
                 valSpan.innerText = buffer[i];
             } else {
                 slot.classList.remove('filled');
                 valSpan.innerText = "";
             }
         }

         // Rotate Pointers
         // Calculate rotation angle for pointers
         const headAngle = (360 / SIZE) * head; 
         const tailAngle = (360 / SIZE) * tail;

         pHead.style.transform = `rotate(${headAngle}deg)`;
         pHead.querySelector('.ptr-tag').style.transform = `rotate(-${headAngle}deg)`; // Keep text upright

         pTail.style.transform = `rotate(${tailAngle}deg)`;
         pTail.querySelector('.ptr-tag').style.transform = `rotate(-${tailAngle}deg)`;

         countLbl.innerText = `Count: ${count}`;
      }

      // 3. Logic
      window.circEnqueue = function() {
          if(count === SIZE) { alert("Buffer Full!"); return; }
          
          const val = Math.floor(Math.random() * 90 + 10);
          buffer[tail] = val;
          
          tail = (tail + 1) % SIZE; // CIRCULAR MATH
          count++;
          
          updateVisuals();
      };

      window.circDequeue = function() {
          if(count === 0) { alert("Buffer Empty!"); return; }
          
          buffer[head] = null;
          
          head = (head + 1) % SIZE; // CIRCULAR MATH
          count--;
          
          updateVisuals();
      };

      // Init
      setTimeout(initRing, 100); // Small delay to ensure DOM is ready

    })();
  </script>

</section>
<section class="slide">
  <style>
    .array-wrapper {
      display: flex; gap: 5px; margin-top: 40px; justify-content: center; position: relative;
    }
    .arr-cell {
      width: 60px; height: 60px;
      border: 2px solid var(--ink); background: white;
      display: grid; place-items: center;
      font-weight: bold; font-family: var(--mono); font-size: 18px;
      position: relative;
    }
    .arr-cell.active { background: #dcfce7; border-color: #16a34a; }
    
    .idx-label {
      position: absolute; bottom: -25px;
      font-size: 12px; color: var(--muted); font-family: var(--mono);
    }

    /* Pointers */
    .q-ptr {
      position: absolute; top: -45px;
      font-weight: 900; font-size: 14px;
      transition: left 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      width: 60px; text-align: center;
    }
    .q-ptr::after { content: "‚Üì"; display: block; font-size: 24px; line-height: 1; }
    .ptr-f { color: #ef4444; } /* Front */
    .ptr-r { color: #2563eb; } /* Rear */

    /* Wrap Indicator Line */
    .wrap-arrow {
      position: absolute; top: -60px; left: 0; right: 0; height: 20px;
      border: 2px dashed #8b5cf6; border-bottom: none;
      display: none;
    }
    .wrap-arrow::before { content: "WRAP"; position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 10px; color: #8b5cf6; font-weight: bold; }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Implementation</div><div class="sub">Circular Array Logic</div></div>
    <span class="pill">Code Execution</span>
  </div>

  <h2>Queue: Array Enqueue/Dequeue</h2>

<div class="grid-2">
  <div>
    <div class="code-block" style="font-size:13px; line-height:1.6; font-family: monospace;">
      
      <span class="comment">// --- Enqueue Operation ---</span><br>
      <span class="keyword">void</span> Enqueue(x) {<br>
      &nbsp;&nbsp;Q[Q.rear] = x; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// 1. Insert data at Rear</span><br>
      &nbsp;&nbsp;Q.rear = (Q.rear + 1) % N; <span class="comment">// 2. Move Rear (Wrap around)</span><br>
      &nbsp;&nbsp;Q.size++; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// 3. Increase size count</span><br>
      }<br>
      <br>
      <span class="comment">// --- Dequeue Operation ---</span><br>
      <span class="keyword">int</span> Dequeue() {<br>
      &nbsp;&nbsp;<span class="keyword">int</span> item = Q[Q.front]; &nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// 1. Save data at Front</span><br>
      &nbsp;&nbsp;Q.front = (Q.front + 1) % N; <span class="comment">// 2. Move Front (Wrap around)</span><br>
      &nbsp;&nbsp;Q.size--; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// 3. Decrease size count</span><br>
      &nbsp;&nbsp;<span class="keyword">return</span> item; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">// 4. Return saved item</span><br>
      }<br>
      
    </div>

 

      <div class="callout" style="display:flex; gap:10px; align-items:center;">
        <button class="mini-btn" onclick="runArrEnq()" style="background:#2563eb; border-color:#2563eb;">Enqueue(Rand)</button>
        <button class="mini-btn" onclick="runArrDeq()" style="background:#ef4444; border-color:#ef4444;">Dequeue()</button>
        <div id="q-arr-status" style="font-size:12px; font-weight:bold; color:var(--muted); margin-left:10px;">Ready</div>
      </div>
    </div>

    <div class="card" style="padding:20px; display:flex; flex-direction:column; justify-content:center;">
      
      <div style="position:relative; margin-top:30px;">
         <div id="vis-ptr-f" class="q-ptr ptr-f" style="left:0;">FRONT</div>
         <div id="vis-ptr-r" class="q-ptr ptr-r" style="left:0;">REAR</div>
         
         <div class="array-wrapper" id="vis-arr-stage">
            <div class="arr-cell" id="c-0"><div class="idx-label">0</div></div>
            <div class="arr-cell" id="c-1"><div class="idx-label">1</div></div>
            <div class="arr-cell" id="c-2"><div class="idx-label">2</div></div>
            <div class="arr-cell" id="c-3"><div class="idx-label">3</div></div>
            <div class="arr-cell" id="c-4"><div class="idx-label">4</div></div>
         </div>
      </div>

      <div style="margin-top:40px; font-size:13px; color:var(--muted); text-align:center;">
        <strong>Note:</strong> <code>rear</code> points to the <em>next available</em> slot.<br>
        When it hits Index 4, the next step wraps back to 0.
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing the Wrap Logic</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const SIZE = 5;
      let front = 0;
      let rear = 0;
      let count = 0;
      
      const ptrF = document.getElementById('vis-ptr-f');
      const ptrR = document.getElementById('vis-ptr-r');
      const status = document.getElementById('q-arr-status');
      
      // Calculate pixel offset for pointers (Width 60 + Gap 5 = 65px per step)
      function updatePtrs() {
        ptrF.style.left = (front * 65) + "px";
        ptrR.style.left = (rear * 65) + "px";
        
        // Offset vertically if they collide
        if(front === rear) {
            ptrR.style.transform = "translateY(-35px)";
            ptrF.style.opacity = "0.5";
        } else {
            ptrR.style.transform = "translateY(0)";
            ptrF.style.opacity = "1";
        }
      }

      window.runArrEnq = function() {
        if(count === SIZE) { status.innerText="Full!"; return; }
        
        const val = Math.floor(Math.random()*90+10);
        
        // 1. Assign to Q[rear]
        const cell = document.getElementById(`c-${rear}`);
        cell.innerText = val;
        cell.classList.add('active');
        
        // 2. Move Rear
        rear = (rear === SIZE - 1) ? 0 : rear + 1;
        count++;
        
        updatePtrs();
        status.innerText = `Enqueued ${val}`;
      };

      window.runArrDeq = function() {
        if(count === 0) { status.innerText="Empty!"; return; }
        
        // 1. Get from Q[front]
        const cell = document.getElementById(`c-${front}`);
        const val = cell.innerText;
        cell.innerText = "";
        cell.classList.remove('active');
        
        // 2. Move Front
        front = (front === SIZE - 1) ? 0 : front + 1;
        count--;
        
        updatePtrs();
        status.innerText = `Dequeued ${val}`;
      };
      
      updatePtrs();
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Node Visual Comparison */
    .node-comparison {
      display: flex; flex-direction: column; gap: 30px;
      align-items: center; justify-content: center; height: 100%;
    }
    
    .p-node-box {
      display: flex;
      border: 2px solid var(--ink); border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      font-family: var(--mono); font-size: 14px;
    }
    
    .p-field { padding: 10px 15px; border-right: 1px solid var(--ink); background: white; }
    .p-field:last-child { border-right: none; }
    .p-field.priority { background: #fef08a; font-weight: bold; color: #854d0e; }
    .p-field.next { background: #e2e8f0; color: var(--muted); }

    .label-tag {
      font-size: 12px; text-transform: uppercase; font-weight: bold; color: var(--muted);
      margin-bottom: 5px; text-align: center;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Data Structures</div><div class="sub">Ordered Retrieval</div></div>
    <span class="pill">Priority Queue</span>
  </div>

  <h2>Priority Queue: The Concept</h2>

  <div class="grid-2">
    <div>
      <p>A queue where elements are retrieved based on a <strong>Priority Value</strong>, not just arrival time.</p>
      
      <div class="code-block" style="margin-top:20px; font-size:14px;">
<span class="keyword">public class</span> Node
{
    <span class="keyword">public</span> Node next;
    <span class="keyword">public</span> Object data;
    
    <span class="comment">// The defining feature:</span>
    <span class="keyword">public int</span> priority; 
}
      </div>

      <div class="callout" style="border-left-color:#eab308; background:#fefce8;">
        <strong>The Rule:</strong><br>
        Higher priority values are typically retrieved (Dequeued) before lower priority ones.
      </div>
    </div>

    <div class="card" style="padding:30px;">
      <div class="node-comparison">
        
        <div>
          <div class="label-tag">Standard Queue Node</div>
          <div class="p-node-box" style="opacity:0.6;">
             <div class="p-field">Data</div>
             <div class="p-field next">Next ‚ûî</div>
          </div>
        </div>

        <div style="font-size:24px; color:var(--muted);">vs</div>

        <div>
          <div class="label-tag" style="color:#ca8a04;">Priority Node</div>
          <div class="p-node-box" style="transform:scale(1.1); border-color:#ca8a04;">
             <div class="p-field">Data</div>
             <div class="p-field priority">Priority (int)</div>
             <div class="p-field next">Next ‚ûî</div>
          </div>
        </div>
        
        <p style="text-align:center; font-size:14px; color:var(--muted); margin-top:20px;">
            The priority value determines the node's position in the line.
        </p>

      </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Structure Definition</div><div class="slide-no" data-slide-no></div></div>
</section>

<section class="slide">
  <style>
    /* Hospital Queue Visual */
    .er-queue {
      display: flex; flex-direction: column; gap: 10px;
      margin-top: 20px;
      padding: 15px; border: 2px solid var(--soft);
      background: #f1f5f9; border-radius: 12px;
      min-height: 250px;
    }
    
    .patient-card {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 15px; background: white; border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      font-family: var(--sans);
      animation: flashIn 0.3s;
    }
    
    .p-tag { font-weight: bold; font-size: 12px; text-transform: uppercase; padding: 4px 8px; border-radius: 4px; }
    .tag-crit { background: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5; }
    .tag-low  { background: #eff6ff; color: #1e40af; border: 1px solid #bfdbfe; }
    
    .starving {
      border: 2px dashed #ef4444; opacity: 0.7;
      transition: all 0.3s;
    }

    @keyframes flashIn { from { transform: translateX(-20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Real World Issues</div><div class="sub">Priority Queue Pitfalls</div></div>
    <span class="pill">Starvation</span>
  </div>

  <h2>Special Consideration: Starvation</h2>

  <div class="grid-2">
    <div>
      <p>Have you ever waited hours in an ER because critical cases kept arriving?</p>
      
      <div class="card" style="margin-top:15px; border-left: 5px solid #ef4444;">
        <h4 style="margin:0 0 10px 0;">The Problem:</h4>
        <p style="font-size:16px;">
          <strong>Starvation</strong> occurs when low-priority elements are constantly passed over by incoming high-priority elements.
        </p>
        <p style="font-size:16px; margin-top:10px;">
          <strong>Result:</strong> They may never get processed.
        </p>
      </div>

      <div style="margin-top:25px;">
        <div style="font-size:13px; font-weight:bold; color:var(--muted); margin-bottom:5px;">QUEUE CONTROLS:</div>
        
        <div style="display:flex; gap:10px;">
            <button class="mini-btn" onclick="addCritical()" style="flex:1; background:#ef4444; border-color:#b91c1c; font-size:15px;">
                üö® Emergency
            </button>
            <button class="mini-btn" onclick="processPatient()" style="flex:1; background:#16a34a; border-color:#15803d; font-size:15px;">
                ‚úÖ Proceed
            </button>
        </div>

        <p style="font-size:13px; color:var(--muted); margin-top:10px;">
           Try to <strong>Proceed</strong> to Bob. If you keep clicking <strong>Emergency</strong>, he will never reach the front.
        </p>
      </div>
    </div>

    <div class="card" style="padding:20px;">
       <div style="font-weight:bold; color:var(--ink); margin-bottom:10px;">ER WAITING LIST (Front ‚ûî Back)</div>
       
       <div class="er-queue" id="er-list">
         <div class="patient-card">
             <span>Jane (Heart Attack)</span> <span class="p-tag tag-crit">Priority 1</span>
         </div>
         <div class="patient-card">
             <span>Steve (Broken Leg)</span> <span class="p-tag tag-crit">Priority 2</span>
         </div>
         <div class="patient-card starving" id="victim-bob">
             <span>Bob (Flu)</span> <span class="p-tag tag-low">Priority 10</span>
         </div>
       </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Why Bob waits 5 hours</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const list = document.getElementById('er-list');
      const bob = document.getElementById('victim-bob');
      
      window.addCritical = function() {
        if(list.children.length > 6) { alert("ER Full! But Bob is still waiting..."); return; }

        // Create new Critical Patient
        const el = document.createElement('div');
        el.className = 'patient-card';
        el.innerHTML = `<span>New Emergency</span> <span class="p-tag tag-crit">Priority 1</span>`;
        
        // Insert BEFORE Bob (because Bob is Priority 10)
        // If Bob is gone, just add to end
        if(list.contains(bob)) {
             list.insertBefore(el, bob);
             
             // Visual effect on Bob to show he is sad
             bob.style.opacity = parseFloat(bob.style.opacity || 0.7) - 0.1;
             if(bob.style.opacity < 0.2) bob.style.opacity = 0.2;
        } else {
             list.appendChild(el);
        }
      };

      // NEW PROCESS FUNCTION
      window.processPatient = function() {
        if(list.children.length === 0) {
            alert("Waiting room is empty!");
            return;
        }

        // Identify the patient at the front
        const processed = list.firstElementChild;

        // Check if it's Bob
        if(processed.id === 'victim-bob') {
            alert("Success! Bob finally got to see the doctor.");
        }

        // Remove from DOM
        processed.remove();
      };

    })();
  </script>
</section>

<section class="slide">
  <style>
    /* Lakeridge Theme */
    .lh-header {
      background: #005eb8; color: white;
      padding: 15px; border-radius: 8px 8px 0 0;
      display: flex; justify-content: space-between; align-items: center;
    }
    .lh-logo { font-weight: bold; font-size: 18px; display: flex; align-items: center; gap: 10px; }
    
    /* Queue Container */
    .triage-box {
      background: white; border: 1px solid #cbd5e1;
      border-radius: 0 0 8px 8px;
      padding: 20px;
      min-height: 300px;
      display: flex; flex-direction: column;
    }

    /* Patient List */
    .patient-list {
      flex-grow: 1;
      display: flex; flex-direction: column; gap: 8px;
      margin-bottom: 20px;
    }

    /* Patient Card */
    .p-card {
      display: flex; justify-content: space-between; align-items: center;
      padding: 12px; border-radius: 6px;
      background: #f8fafc; border-left: 5px solid #cbd5e1;
      font-family: var(--sans); box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      animation: slideIn 0.3s ease-out;
    }
    
    /* Triage Levels */
    .p-level-1 { border-left-color: #ef4444; background: #fef2f2; } /* Critical */
    .p-level-2 { border-left-color: #eab308; background: #fefce8; } /* Urgent */
    .p-level-3 { border-left-color: #22c55e; background: #f0fdf4; } /* Non-Urgent */

    .badge {
      font-size: 11px; font-weight: bold; text-transform: uppercase;
      padding: 3px 6px; border-radius: 4px; color: white;
    }
    .bg-red { background: #ef4444; }
    .bg-yellow { background: #eab308; color: black; }
    .bg-green { background: #22c55e; }

    /* Controls */
    .control-panel {
      display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;
      margin-top: auto; border-top: 1px solid #e2e8f0; padding-top: 15px;
    }
    .btn-triage {
      padding: 10px; border: none; border-radius: 6px;
      font-weight: bold; cursor: pointer; color: white;
      transition: transform 0.1s;
    }
    .btn-triage:active { transform: scale(0.98); }

    /* Stats */
    .stat-bar {
      display: flex; gap: 15px; font-size: 13px; color: #64748b;
      margin-bottom: 15px; border-bottom: 1px solid #e2e8f0; padding-bottom: 10px;
    }

    @keyframes slideIn { from { opacity:0; transform: translateY(10px); } to { opacity:1; transform: translateY(0); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Data Structures in Practice</div><div class="sub">Priority Queues</div></div>
    <span class="pill">Real World Example</span>
  </div>

  <h2>Case Study: Lakeridge Health Oshawa</h2>

  <div class="grid-2">
    <div>
      <p>
        In an ER, "First-In, First-Out" (FIFO) can be fatal. Hospitals use a <strong>Priority Queue</strong> based on the Triage capability.
      </p> 
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">CTAS Triage Levels:</h4>
        <ul style="font-size:14px; line-height: 1.6;">
          <li><span style="color:#ef4444; font-weight:bold;">Resuscitation (Level 1):</span> Immediate life threat. (e.g., Cardiac Arrest)</li>
          <li><span style="color:#eab308; font-weight:bold;">Urgent (Level 3):</span> Potential danger. (e.g., Broken Bone)</li>
          <li><span style="color:#22c55e; font-weight:bold;">Non-Urgent (Level 5):</span> Minor care. (e.g., Prescription refill)</li>
        </ul>
      </div>

      <p style="font-size:14px; color:var(--muted); margin-top:20px;">
        <em>Note: If you add a Level 1 patient, they will skip the line. This pushes everyone else's wait time up.</em>
      </p>
    </div>

    <div>
      <div class="lh-header">
        <div class="lh-logo">üè• Lakeridge Health Oshawa</div>
        <div style="font-size:12px; opacity:0.9;">ER WAIT TIMES TRACKER</div>
      </div>
      
      <div class="triage-box">
        <div class="stat-bar">
          <span id="q-count">Patients Waiting: 0</span>
          <span id="q-wait">Est. Wait: 0h 0m</span>
        </div>

        <div class="patient-list" id="lh-queue">
          <div style="text-align:center; color:#94a3b8; margin-top:40px; font-style:italic;" id="empty-msg">
            Waiting Room Empty
          </div>
        </div>

        <div class="control-panel">
          <button class="btn-triage bg-green" onclick="addPatient(3)">
            + Walk-in<br><span style="font-size:10px; font-weight:normal;">(Low Priority)</span>
          </button>
          <button class="btn-triage bg-red" onclick="addPatient(1)">
            + Ambulance<br><span style="font-size:10px; font-weight:normal;">(High Priority)</span>
          </button>
          <button class="btn-triage" style="background:#334155;" onclick="treatPatient()">
            üë®‚Äç‚öïÔ∏è Treat<br><span style="font-size:10px; font-weight:normal;">(Remove Top)</span>
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Interactive Triage Simulation</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // Priority Queue Array (Simple Object Array)
      let queue = [];
      const listContainer = document.getElementById('lh-queue');
      const emptyMsg = document.getElementById('empty-msg');
      const countLabel = document.getElementById('q-count');
      const waitLabel = document.getElementById('q-wait');

      // Names for flavor
      const names = ["Alex", "Jordan", "Taylor", "Casey", "Riley", "Morgan", "Quinn"];
      const injuries = {
        1: ["Cardiac Arrest", "Severe Trauma", "Stroke"],
        3: ["Broken Arm", "High Fever", "Cut requiring stitches"], 
        5: ["Sore Throat", "Prescription", "Sprained Ankle"] // Mapped to code 3 for simplicity in UI
      };

      window.addPatient = function(level) {
        // 1. Create Data Object
        const name = names[Math.floor(Math.random() * names.length)];
        const condList = (level === 1) ? injuries[1] : injuries[3];
        const condition = condList[Math.floor(Math.random() * condList.length)];
        
        const patient = {
          id: Date.now(),
          name: name,
          condition: condition,
          level: level // 1 is High, 3 is Low
        };

        // 2. Insert into Queue (Priority Logic)
        queue.push(patient);
        // Sort: Lower level number = Higher Priority
        queue.sort((a, b) => a.level - b.level);

        renderQueue();
      };

      window.treatPatient = function() {
        if(queue.length === 0) { alert("No patients to treat."); return; }
        
        // Remove first element (Highest Priority)
        const treated = queue.shift();
        renderQueue();
      };

      function renderQueue() {
        listContainer.innerHTML = "";
        
        if(queue.length === 0) {
          listContainer.appendChild(emptyMsg);
          emptyMsg.style.display = "block";
          countLabel.innerText = "Patients Waiting: 0";
          waitLabel.innerText = "Est. Wait: 0h 0m";
          return;
        }

        emptyMsg.style.display = "none";

        // Calculate Wait Time (Fake Logic: 30m per patient + 1h base)
        const totalMins = queue.length * 45; 
        const hours = Math.floor(totalMins / 60);
        const mins = totalMins % 60;
        waitLabel.innerText = `Est. Wait: ${hours}h ${mins}m`;
        countLabel.innerText = `Patients Waiting: ${queue.length}`;

        // Render DOM
        queue.forEach(p => {
          const el = document.createElement('div');
          
          // Style based on level
          let cssClass = (p.level === 1) ? "p-level-1" : "p-level-3";
          let badgeClass = (p.level === 1) ? "bg-red" : "bg-green";
          let levelText = (p.level === 1) ? "LEVEL 1" : "LEVEL 3";

          el.className = `p-card ${cssClass}`;
          el.innerHTML = `
            <div>
              <div style="font-weight:bold; font-size:14px;">${p.name}</div>
              <div style="font-size:12px; color:#475569;">${p.condition}</div>
            </div>
            <span class="badge ${badgeClass}">${levelText}</span>
          `;
          listContainer.appendChild(el);
        });
      }

    })();
  </script>

</section>

<section class="slide">
  <style>
    /* Hashing Diagram Flow */
    .hash-flow {
      display: flex; align-items: center; justify-content: center;
      gap: 15px; margin-top: 30px;
    }
    
    .flow-box {
      border: 2px solid var(--ink); border-radius: 8px;
      padding: 15px; text-align: center;
      font-family: var(--mono); font-weight: bold;
      background: white; box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      min-width: 100px;
    }

    .flow-arrow { font-size: 24px; color: var(--muted); }

    /* The Hash Function Machine Visual */
    .hash-machine {
      background: var(--accent); color: white;
      border: none;
      animation: pulseMachine 2s infinite;
    }
    
    /* Result Box */
    .hash-result-idx {
      background: #f1f5f9; border-style: dashed; color: var(--muted);
    }
    .hash-result-idx.active {
      background: #dcfce7; color: #16a34a; border-style: solid; border-color: #16a34a;
    }

    @keyframes pulseMachine {
      0% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(22, 163, 74, 0); }
      100% { box-shadow: 0 0 0 0 rgba(22, 163, 74, 0); }
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Fast Lookups</div><div class="sub">Key-Value Mapping</div></div>
    <span class="pill">Hash Tables</span>
  </div>

  <h2>What is Hashing?</h2>

  <div class="grid-2">
    <div>
      <p>A technique to map **Keys** to **Values** in an array for fast access.</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0; color:var(--ink);">Core Components:</h4>
        <ul style="line-height:1.6; font-size:16px;">
          <li><strong>Key:</strong> The input data (e.g., "John", "Product-ID").</li>
          <li><strong>Hash Function:</strong> A math formula that converts the Key into an integer.</li>
          <li><strong>Hash Index:</strong> The result of the function. Determines where data lives in the array.</li>
        </ul>
      </div>

      <div style="margin-top:20px; font-size:14px; color:var(--muted);">
        <strong>Purpose:</strong> Optimization. We want direct access instead of searching.
      </div>
    </div>

    <div class="card" style="padding:30px; display:flex; flex-direction:column; justify-content:center;">
      
      <div style="text-align:center; font-weight:bold; color:var(--muted); font-size:12px;">HASHING PIPELINE</div>

      <div class="hash-flow">
        <div class="flow-box">
           <input type="text" id="h-key-input" placeholder="Type Key" maxlength="8" style="width:80px; border:none; text-align:center; font-family:var(--mono); outline:none;" onkeyup="runHashDemo()">
           <div style="font-size:10px; color:var(--muted); margin-top:5px;">KEY</div>
        </div>

        <div class="flow-arrow">‚ûî</div>

        <div class="flow-box hash-machine">
           <div style="font-size:20px;">∆í(x)</div>
           <div style="font-size:10px; opacity:0.8;">HASH FUNC</div>
        </div>

        <div class="flow-arrow">‚ûî</div>

        <div class="flow-box hash-result-idx" id="h-res-box">
           <div id="h-idx-val" style="font-size:20px;">?</div>
           <div style="font-size:10px; margin-top:5px;">INDEX</div>
        </div>
      </div>
      
      <div id="hash-calc-detail" style="text-align:center; margin-top:25px; font-family:var(--mono); font-size:12px; color:var(--muted); min-height:20px;">
         Type a key to see the math.
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Key ‚ûî Function ‚ûî Index</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      window.runHashDemo = function() {
        const input = document.getElementById('h-key-input').value;
        const resBox = document.getElementById('h-res-box');
        const valDisp = document.getElementById('h-idx-val');
        const detail = document.getElementById('hash-calc-detail');
        
        if(input.length === 0) {
            resBox.className = "flow-box hash-result-idx";
            valDisp.innerText = "?";
            detail.innerText = "Type a key to see the math.";
            return;
        }

        // Simple Hash: Sum of ASCII codes % 10
        let sum = 0;
        for(let i=0; i<input.length; i++) {
            sum += input.charCodeAt(i);
        }
        const index = sum % 10;

        resBox.className = "flow-box hash-result-idx active";
        valDisp.innerText = index;
        detail.innerHTML = `ASCII Sum: ${sum} <br> ${sum} % 10 = <strong>${index}</strong>`;
      };
    })();
  </script>

</section>


<section class="slide">
  <style>
    /* Technique Grid */
    .tech-grid {
      display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;
      margin-bottom: 20px;
    }
    
    .tech-btn {
      padding: 10px; background: white; border: 1px solid var(--soft);
      border-radius: 8px; cursor: pointer; text-align: center;
      transition: all 0.2s; font-size: 14px; font-weight: bold; color: var(--muted);
    }
    .tech-btn:hover { border-color: var(--accent); color: var(--accent); }
    .tech-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

    /* Calculation Display Area */
    .calc-display {
      background: #1e293b; color: #f8fafc;
      padding: 20px; border-radius: 8px;
      font-family: var(--mono); font-size: 16px;
      min-height: 120px;
      display: flex; flex-direction: column; justify-content: center; align-items: center;
      border: 1px solid #334155;
    }
    
    .calc-step { margin-bottom: 8px; opacity: 0; animation: fadeInStep 0.5s forwards; }
    .calc-result { font-size: 24px; color: #4ade80; font-weight: bold; margin-top: 10px; }

    @keyframes fadeInStep { to { opacity: 1; } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Algorithms</div><div class="sub">Common Strategies</div></div>
    <span class="pill">Hash Techniques</span>
  </div>

  <h2>Types of Hash Functions</h2>

  <div class="grid-2">
    <div>
      <p>A good hash function distributes values uniformly to avoid collisions.</p>
      
      <div class="card" style="margin-top:15px;">
        <h4 style="margin:0 0 10px 0;">Common Methods:</h4>
        <ul style="font-size:15px; line-height:1.6;">
          <li><strong>Modulo Division:</strong> The simplest. <code>Key % TableSize</code>.</li>
          <li><strong>Mid-Square:</strong> Square the key, extract middle digits. Good for randomization.</li>
          <li><strong>Folding:</strong> Chop key into parts, sum them up.</li>
          <li><strong>Cryptographic:</strong> MD5, SHA-256 (Too slow for hash tables, used for security).</li>
        </ul>
      </div>
    </div>

    <div class="card" style="padding:20px;">
      <div style="font-weight:bold; color:var(--muted); font-size:12px; margin-bottom:10px;">INTERACTIVE CALCULATION (Input: 1234)</div>
      
      <div class="tech-grid">
         <div class="tech-btn" onclick="demoHashTech('mod', this)">Modulo</div>
         <div class="tech-btn" onclick="demoHashTech('mid', this)">Mid-Square</div>
         <div class="tech-btn" onclick="demoHashTech('fold', this)">Folding</div>
      </div>

      <div class="calc-display" id="hash-calc-area">
          <div style="color:#94a3b8;">Select a technique to see the math.</div>
      </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing the Math</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const display = document.getElementById('hash-calc-area');
      const inputVal = 1234; // Fixed for demo simplicity
      
      window.demoHashTech = function(type, btn) {
        // Active State UI
        document.querySelectorAll('.tech-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        display.innerHTML = ""; // Clear
        
        let steps = [];
        
        if(type === 'mod') {
            steps = [
                `Input Key: ${inputVal}`,
                `Table Size: 100`,
                `Formula: ${inputVal} % 100`,
                `<div class="calc-result">Index: 34</div>`
            ];
        } else if(type === 'mid') {
            const sq = inputVal * inputVal;
            const strSq = sq.toString(); // 1522756
            // Middle is approx indices 2,3 -> "22" or "27" depending on logic
            steps = [
                `Input Key: ${inputVal}`,
                `Square: ${inputVal}¬≤ = ${sq}`,
                `Extract Middle: 15[22]756`,
                `<div class="calc-result">Index: 22</div>`
            ];
        } else if(type === 'fold') {
            // Fold 12 and 34
            steps = [
                `Input Key: ${inputVal}`,
                `Split Groups: "12", "34"`,
                `Sum: 12 + 34`,
                `<div class="calc-result">Index: 46</div>`
            ];
        }

        // Animate Steps
        steps.forEach((txt, i) => {
            setTimeout(() => {
                const div = document.createElement('div');
                div.className = 'calc-step';
                div.innerHTML = txt;
                display.appendChild(div);
            }, i * 400);
        });
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Character Mapping Grid */
    .char-map-grid {
      display: grid; grid-template-columns: repeat(5, 1fr); gap: 5px;
      margin-bottom: 20px;
    }
    
    .char-box {
      border: 1px solid var(--soft); padding: 5px; text-align: center; font-size: 12px;
      font-family: var(--mono); background: white; border-radius: 4px;
    }
    .char-box.highlight { background: #fef08a; border-color: #eab308; color: #854d0e; font-weight: bold; }

    /* Calculation Visual */
    .sum-visual {
      display: flex; align-items: center; justify-content: center; gap: 10px;
      font-size: 24px; font-weight: bold; margin-top: 20px;
      background: #f1f5f9; padding: 20px; border-radius: 12px;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Example</div><div class="sub">Step 1: Numeric Representation</div></div>
    <span class="pill">String to Int</span>
  </div>

  <h2>Hashing: Simple Example</h2>

  <div class="grid-2">
    <div>
      <p>How do we turn a string like "ab" into a number?</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">Method: Character Sum</h4>
        <ul style="line-height:1.6; margin:0; padding-left:20px;">
          <li>Assign values: a=1, b=2, c=3...</li>
          <li>Sum the characters.</li>
        </ul>
        
        <div style="margin-top:15px; font-family:var(--mono); background:#f8fafc; padding:10px; border-radius:6px; font-size:14px;">
           "ab" &nbsp;‚ûî 1 + 2 = <strong>3</strong><br>
           "cd" &nbsp;‚ûî 3 + 4 = <strong>7</strong><br>
           "efg" ‚ûî 5 + 6 + 7 = <strong>18</strong>
        </div>
      </div>
    </div>

    <div class="card" style="padding:20px;">
      
      <div style="font-size:12px; font-weight:bold; color:var(--muted); margin-bottom:10px;">TRY IT YOURSELF</div>
      
      <div class="char-map-grid" id="char-grid">
         </div>
      
      <input type="text" id="str-input" maxlength="5" placeholder="Type (e.g. ab)" 
             style="width:100%; padding:10px; font-size:18px; text-align:center; border:2px solid var(--accent); border-radius:8px; outline:none;"
             onkeyup="calcSum()">
      
      <div class="sum-visual" id="sum-display">
         0
      </div>
      <div style="text-align:center; font-size:12px; color:var(--muted); margin-top:5px;">Numerical Value</div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Converting Text to Numbers</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const grid = document.getElementById('char-grid');
      const input = document.getElementById('str-input');
      const display = document.getElementById('sum-display');

      // Init Grid (a-j)
      const chars = "abcdefghij";
      for(let i=0; i<chars.length; i++) {
          const div = document.createElement('div');
          div.className = 'char-box';
          div.id = `char-${chars[i]}`;
          div.innerText = `${chars[i]} = ${i+1}`;
          grid.appendChild(div);
      }

      window.calcSum = function() {
        const val = input.value.toLowerCase();
        let sum = 0;
        let formula = "";
        
        // Reset highlights
        document.querySelectorAll('.char-box').forEach(b => b.classList.remove('highlight'));

        for(let i=0; i<val.length; i++) {
            const code = val.charCodeAt(i) - 96; // a=1
            if(code >= 1 && code <= 26) {
                sum += code;
                formula += (i===0 ? "" : " + ") + code;
                
                // Highlight logic
                const char = val[i];
                const box = document.getElementById(`char-${char}`);
                if(box) box.classList.add('highlight');
            }
        }
        
        if(val.length > 0) {
            display.innerHTML = `<span style="font-size:16px; color:#64748b;">${formula} = </span> ${sum}`;
        } else {
            display.innerText = "0";
        }
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* ASCII Breakdown Visual */
    .ascii-breakdown {
      display: flex; flex-direction: column; gap: 10px;
      margin-top: 20px;
    }
    .ascii-row {
      display: flex; align-items: center; justify-content: space-between;
      background: white; border: 1px solid var(--soft);
      padding: 10px 15px; border-radius: 8px;
      font-family: var(--mono);
      animation: slideInAscii 0.3s ease;
    }
    .char-badge {
      background: #eff6ff; color: #2563eb; font-weight: bold;
      padding: 4px 10px; border-radius: 4px; border: 1px solid #bfdbfe;
    }
    .ascii-val { font-weight: bold; color: var(--ink); }

    /* Total Box */
    .total-box {
      background: #1e293b; color: #f8fafc;
      padding: 15px; border-radius: 8px; text-align: center;
      font-family: var(--mono); font-size: 18px; margin-top: 20px;
    }

    @keyframes slideInAscii { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Real Implementation</div><div class="sub">Using Character Codes</div></div>
    <span class="pill">ASCII Hashing</span>
  </div>

  <h2>Hashing: ASCII Example</h2>

  <div class="grid-2">
    <div>
      <p>Computers store text as numbers known as <strong>ASCII</strong> codes.</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">The Process:</h4>
        <ul style="line-height:1.6; margin:0; padding-left:20px;">
          <li><strong>Step 1:</strong> Get ASCII value of each character.</li>
          <li><strong>Step 2:</strong> Sum them up to get a "Hash Code".</li>
        </ul>
        
        <div style="margin-top:15px; background:#f8fafc; padding:10px; border-radius:6px; font-size:14px; color:var(--muted);">
           <strong>Example:</strong> "CAT"<br>
           'C' = 67<br>
           'A' = 65<br>
           'T' = 84<br>
           Sum = <strong>216</strong>
        </div>
      </div>
    </div>

    <div class="card" style="padding:20px; min-height:400px; display:flex; flex-direction:column;">
      
      <div style="font-weight:bold; color:var(--muted); font-size:12px; margin-bottom:10px;">ASCII SUM CALCULATOR</div>
      
      <input type="text" id="ascii-input" maxlength="6" placeholder="Type a word (e.g. Dog)" 
             style="width:100%; padding:12px; font-size:16px; border:2px solid var(--accent); border-radius:8px; outline:none; text-align:center;"
             onkeyup="calcAscii()">
      
      <div class="ascii-breakdown" id="ascii-list">
         <div style="text-align:center; color:#cbd5e1; margin-top:20px;">Type above to see values</div>
      </div>

      <div class="total-box" id="ascii-total">
          Total Sum: 0
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">From Text to Integer</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const input = document.getElementById('ascii-input');
      const list = document.getElementById('ascii-list');
      const totalBox = document.getElementById('ascii-total');

      window.calcAscii = function() {
        const val = input.value;
        list.innerHTML = "";
        let sum = 0;

        if(val.length === 0) {
            list.innerHTML = "<div style='text-align:center; color:#cbd5e1; margin-top:20px;'>Type above to see values</div>";
            totalBox.innerText = "Total Sum: 0";
            return;
        }

        for(let i=0; i<val.length; i++) {
            const char = val[i];
            const code = val.charCodeAt(i);
            sum += code;

            const row = document.createElement('div');
            row.className = 'ascii-row';
            row.innerHTML = `<span class="char-badge">'${char}'</span> <span class="ascii-val">${code}</span>`;
            list.appendChild(row);
        }

        totalBox.innerHTML = `Total Sum: <span style="color:#4ade80; font-weight:bold;">${sum}</span>`;
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Bucket Visualization */
    .bucket-stage {
      display: flex; gap: 10px; justify-content: center; align-items: flex-end;
      height: 200px; margin-top: 20px;
      border-bottom: 2px solid var(--ink); padding-bottom: 5px;
    }
    
    .ht-bucket {
      width: 80px; height: 100%;
      border: 2px dashed var(--soft); border-bottom: none;
      border-radius: 8px 8px 0 0;
      background: rgba(255,255,255,0.5);
      display: flex; flex-direction: column-reverse;
      padding: 5px; gap: 5px;
      position: relative;
      transition: background 0.2s;
    }
    .ht-bucket.active { background: #dcfce7; border-color: #16a34a; }
    
    .bucket-lbl {
      position: absolute; bottom: -25px; left: 0; right: 0;
      text-align: center; font-size: 12px; color: var(--muted); font-weight: bold;
    }

    .ht-item {
      background: var(--accent); color: white;
      padding: 6px; font-size: 12px; text-align: center;
      border-radius: 4px; font-weight: bold;
      animation: dropInItem 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    
    @keyframes dropInItem { from{opacity:0; transform:translateY(-50px);} to{opacity:1; transform:translateY(0);} }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Data Structures</div><div class="sub">Key/Value Collections</div></div>
    <span class="pill">System.Collections</span>
  </div>

  <h2>Hashtable: The Concept</h2>

  <div class="grid-2">
    <div>
      <p>A collection of Key/Value pairs organized by the <strong>Hash Code</strong> of the key.</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">How it Optimizes:</h4>
        <ul style="line-height:1.6; margin:0; padding-left:20px;">
          <li>Calculates Hash Code of Key.</li>
          <li>Uses code to find a specific "Bucket".</li>
          <li>Stores item in that bucket.</li>
        </ul>
      </div>

      <div class="code-block" style="margin-top:20px; font-size:13px;">
<span class="keyword">using</span> System.Collections;

Hashtable ht = <span class="keyword">new</span> Hashtable();
ht.Add(<span class="string">"ID_1"</span>, <span class="string">"Ahmad"</span>);
ht.Add(<span class="string">"ID_2"</span>, <span class="string">"Sarah"</span>);
      </div>
    </div>

    <div class="card" style="padding:20px;">
      
      <div style="font-weight:bold; color:var(--muted); font-size:12px; text-align:center;">BUCKET STORAGE SYSTEM</div>
      
      <div style="margin:15px 0; display:flex; gap:10px;">
         <input type="text" id="ht-input" placeholder="Enter Key (e.g. A1)" style="flex:1; padding:8px; border-radius:6px; border:1px solid var(--soft);">
         <button class="mini-btn" onclick="addToBucket()" style="background:var(--accent); border-color:var(--accent);">Add</button>
      </div>

      <div class="bucket-stage">
         <div class="ht-bucket" id="buc-0"><div class="bucket-lbl">Bucket 0</div></div>
         <div class="ht-bucket" id="buc-1"><div class="bucket-lbl">Bucket 1</div></div>
         <div class="ht-bucket" id="buc-2"><div class="bucket-lbl">Bucket 2</div></div>
         <div class="ht-bucket" id="buc-3"><div class="bucket-lbl">Bucket 3</div></div>
      </div>
      
      <div id="bucket-log" style="text-align:center; font-size:12px; color:var(--muted); margin-top:30px;">
         Ready.
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Optimized Lookup via Hashing</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const log = document.getElementById('bucket-log');
      const inp = document.getElementById('ht-input');
      
      window.addToBucket = function() {
         const key = inp.value;
         if(!key) return;
         
         // Simple Hash
         let sum = 0;
         for(let i=0; i<key.length; i++) sum += key.charCodeAt(i);
         const idx = sum % 4; // 4 buckets
         
         log.innerHTML = `Key "${key}" (Sum ${sum}) % 4 = <strong>Bucket ${idx}</strong>`;
         
         // Add visual item
         const bucket = document.getElementById(`buc-${idx}`);
         if(bucket.children.length > 4) { alert("Bucket Full!"); return; }
         
         const item = document.createElement('div');
         item.className = 'ht-item';
         item.innerText = key;
         bucket.appendChild(item);
         
         // Highlight
         bucket.classList.add('active');
         setTimeout(() => bucket.classList.remove('active'), 500);
         
         inp.value = "";
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* App Icons Grid */
    .app-grid {
      display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin-bottom: 20px;
    }
    
    .app-icon {
      background: white; border: 1px solid var(--soft);
      border-radius: 12px; padding: 15px; text-align: center;
      cursor: pointer; transition: all 0.2s;
    }
    .app-icon:hover { border-color: var(--accent); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    .app-icon.active { background: #dcfce7; border-color: #16a34a; color: #14532d; }
    
    .icon-emoji { font-size: 28px; margin-bottom: 5px; display: block; }
    .icon-label { font-size: 12px; font-weight: bold; }

    /* Simulation Screen */
    .sim-screen {
      background: #1e293b; color: #f8fafc;
      padding: 20px; border-radius: 12px;
      font-family: var(--mono); min-height: 180px;
      display: flex; flex-direction: column; justify-content: center;
      border: 1px solid #334155;
    }
    
    .sim-row { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 14px; }
    .sim-key { color: #94a3b8; }
    .sim-arrow { color: var(--accent); padding: 0 10px; }
    .sim-val { color: #fff; font-weight: bold; }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Real World</div><div class="sub">Where we use it</div></div>
    <span class="pill">Applications</span>
  </div>

  <h2>Hash Table Applications</h2>

  <div class="grid-2">
    <div>
      <div class="card">
        <h4 style="margin:0 0 15px 0;">Common Use Cases:</h4>
        
        <div style="margin-bottom:15px;">
           <div style="font-weight:bold; color:var(--ink);">üìÇ File & DB Indexing</div>
           <div style="font-size:14px; color:var(--muted);">Linking IDs or Filenames to storage paths instantly.</div>
        </div>

        <div style="margin-bottom:15px;">
           <div style="font-weight:bold; color:var(--ink);">üöÄ Caching Systems</div>
           <div style="font-size:14px; color:var(--muted);">Browser caching uses <code>URL</code> as key to find page content quickly.</div>
        </div>

        <div>
           <div style="font-weight:bold; color:var(--ink);">üìñ Phone Book</div>
           <div style="font-size:14px; color:var(--muted);">Maps <code>Name</code> directly to <code>Number</code> without scanning A-Z.</div>
        </div>
      </div>
    </div>

    <div class="card" style="padding:20px; background:#f8fafc;">
      
      <div style="font-weight:bold; color:var(--muted); font-size:12px; margin-bottom:10px;">SELECT AN APPLICATION</div>
      
      <div class="app-grid">
         <div class="app-icon active" onclick="showApp('db', this)">
            <span class="icon-emoji">üóÑÔ∏è</span>
            <span class="icon-label">Database</span>
         </div>
         <div class="app-icon" onclick="showApp('web', this)">
            <span class="icon-emoji">üåê</span>
            <span class="icon-label">Browser Cache</span>
         </div>
         <div class="app-icon" onclick="showApp('file', this)">
            <span class="icon-emoji">üìÅ</span>
            <span class="icon-label">File System</span>
         </div>
      </div>

      <div class="sim-screen" id="app-sim-screen">
          </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Indexing, Caching, and Lookups</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const screen = document.getElementById('app-sim-screen');
      
      // Initial Load
      setTimeout(() => showApp('db', document.querySelector('.app-icon')), 100);

      window.showApp = function(type, btn) {
        // UI Toggle
        document.querySelectorAll('.app-icon').forEach(b => b.classList.remove('active'));
        if(btn) btn.classList.add('active');

        // Render Content
        if(type === 'db') {
            screen.innerHTML = `
               <div style="color:#64748b; font-size:12px; margin-bottom:10px;">// EMPLOYEE LOOKUP</div>
               <div class="sim-row"><span class="sim-key">Key (ID)</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">1042</span></div>
               <div class="sim-row"><span class="sim-key">Hash Fn</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">Index 42</span></div>
               <div style="margin-top:10px; border-top:1px dashed #334155; padding-top:10px;">
                  <span class="sim-key">Result:</span> <span style="color:#4ade80;">{ Name: "Sarah", Dept: "HR" }</span>
               </div>
            `;
        } else if(type === 'web') {
            screen.innerHTML = `
               <div style="color:#64748b; font-size:12px; margin-bottom:10px;">// BROWSER CACHE</div>
               <div class="sim-row"><span class="sim-key">Key (URL)</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">"google.com"</span></div>
               <div class="sim-row"><span class="sim-key">Hash Fn</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">0x8F3A...</span></div>
               <div style="margin-top:10px; border-top:1px dashed #334155; padding-top:10px;">
                  <span class="sim-key">Result:</span> <span style="color:#4ade80;">[Cached HTML Content]</span>
               </div>
            `;
        } else if(type === 'file') {
            screen.innerHTML = `
               <div style="color:#64748b; font-size:12px; margin-bottom:10px;">// FILE SYSTEM INDEX</div>
               <div class="sim-row"><span class="sim-key">Key (Name)</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">"report.pdf"</span></div>
               <div class="sim-row"><span class="sim-key">Hash Fn</span> <span class="sim-arrow">‚ûî</span> <span class="sim-val">Sector 99</span></div>
               <div style="margin-top:10px; border-top:1px dashed #334155; padding-top:10px;">
                  <span class="sim-key">Path:</span> <span style="color:#4ade80;">C:/Users/Docs/report.pdf</span>
               </div>
            `;
        }
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Memory Visuals */
    .mem-block {
      background: white; border: 1px solid var(--soft);
      border-radius: 8px; padding: 10px; margin-top: 10px;
      min-height: 100px;
      display: flex; flex-direction: column; gap: 5px;
    }
    
    .mem-row {
      display: flex; justify-content: space-between;
      background: #f1f5f9; padding: 8px; border-radius: 4px;
      font-family: var(--mono); font-size: 13px;
      animation: flashGreen 0.5s;
    }

    /* Console Output */
    .console-out {
      background: #1e293b; color: #4ade80;
      font-family: var(--mono); font-size: 12px;
      padding: 10px; border-radius: 6px; margin-top: 15px;
      min-height: 40px; border: 1px solid #334155;
    }

    @keyframes flashGreen { from { background: #dcfce7; } to { background: #f1f5f9; } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">C# Implementation</div><div class="sub">System.Collections</div></div>
    <span class="pill">Basic Operations</span>
  </div>

  <h2>Hash Tables in Practice</h2>

  <div class="grid-2">
    <div>
      <div class="code-block" style="font-size:14px;">
<span class="keyword">using</span> System.Collections;

<span class="comment">// 1. Initialize</span>
Hashtable ht = <span class="keyword">new</span> Hashtable();

<span class="comment">// 2. Add Data</span>
ht.Add(<span class="string">"txt"</span>, <span class="string">"notepad.exe"</span>);
ht.Add(<span class="string">"bmp"</span>, <span class="string">"paint.exe"</span>);

<span class="comment">// 3. Check Key</span>
<span class="keyword">if</span> (ht.ContainsKey(<span class="string">"txt"</span>)) {
    <span class="comment">// Logic here...</span>
}
      </div>

      <div class="callout" style="display:flex; gap:10px; margin-top:15px;">
        <button class="mini-btn" onclick="runCsAdd()">‚ñ∂ Execute .Add()</button>
        <button class="mini-btn" onclick="runCsCheck()" style="background:#f59e0b; border-color:#f59e0b;">‚ñ∂ Execute .ContainsKey()</button>
      </div>
    </div>

    <div class="card" style="padding:20px;">
      
      <div style="font-weight:bold; color:var(--muted); font-size:12px;">IN-MEMORY OBJECT: 'ht'</div>
      
      <div class="mem-block" id="ht-mem-view">
         <div style="text-align:center; color:#94a3b8; font-size:12px; margin-top:30px;" id="ht-empty-lbl">
             Hashtable is empty.
         </div>
      </div>

      <div style="font-weight:bold; color:var(--muted); font-size:12px; margin-top:20px;">CONSOLE / OUTPUT</div>
      <div class="console-out" id="cs-console">
          > Ready...
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Add() and ContainsKey()</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const view = document.getElementById('ht-mem-view');
      const consoleOut = document.getElementById('cs-console');
      const emptyLbl = document.getElementById('ht-empty-lbl');
      let added = false;

      window.runCsAdd = function() {
        if(added) { consoleOut.innerText = "> Items already added."; return; }
        
        emptyLbl.style.display = 'none';
        
        // Simulating adding 2 items
        view.innerHTML += `
          <div class="mem-row">
            <span>["txt"]</span> <span>"notepad.exe"</span>
          </div>
        `;
        
        setTimeout(() => {
             view.innerHTML += `
              <div class="mem-row">
                <span>["bmp"]</span> <span>"paint.exe"</span>
              </div>
            `;
        }, 300);

        consoleOut.innerText = "> Items added to memory.";
        added = true;
      };

      window.runCsCheck = function() {
        if(!added) { 
            consoleOut.innerText = "> Error: Table is empty!"; 
            consoleOut.style.color = "#ef4444";
            return; 
        }
        
        consoleOut.style.color = "#4ade80";
        consoleOut.innerText = "> Checking 'txt'...\n> Found: True";
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Chaining Visuals */
    .chain-container {
      display: flex; flex-direction: column; gap: 15px;
      margin-top: 20px; font-family: var(--mono);
    }
    
    .chain-row {
      display: flex; align-items: center; min-height: 50px;
    }
    
    /* The Array Slot */
    .bucket-head {
      width: 60px; height: 50px;
      background: white; border: 2px solid var(--ink);
      display: grid; place-items: center;
      position: relative; font-weight: bold;
      z-index: 2;
    }
    .bucket-idx {
      position: absolute; left: -25px; color: var(--muted); font-size: 12px;
    }

    /* The Linked List Nodes */
    .chain-node {
      display: flex; align-items: center;
      margin-left: 30px; /* Space for arrow */
      position: relative;
      animation: slideRight 0.4s ease;
    }
    
    .node-box {
      padding: 8px 12px; background: var(--accent); color: white;
      border-radius: 6px; font-size: 14px; font-weight: bold;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    /* Connecting Arrows */
    .chain-node::before {
      content: "‚ûî"; position: absolute; left: -25px;
      color: var(--muted); font-size: 18px;
    }
    
    /* The NULL Pointer */
    .null-ptr {
      margin-left: 15px; font-size: 10px; color: var(--muted); font-weight: bold;
      display: flex; align-items: center; gap: 5px;
    }
    .null-ptr::before { content: "‚Ä¢"; font-size: 20px; }

    @keyframes slideRight { from { opacity: 0; transform: translateX(-20px); } to { opacity: 1; transform: translateX(0); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Theory & Implementation</div><div class="sub">Handling Collisions</div></div>
    <span class="pill">Separate Chaining</span>
  </div>

  <h2>Hash Table as a Linked List</h2>

  <div class="grid-2">
    <div>
      <p>As a theoretical exercise (and practical solution to collisions), we treat each slot in the Hash Table as the <strong>Head</strong> of a Linked List.</p>
      
      <div class="card" style="margin-top:20px;">
        <h4 style="margin:0 0 10px 0;">Why do this?</h4>
        <ul style="line-height:1.6; margin:0; padding-left:20px;">
          <li><strong>Collisions:</strong> What if two keys hash to the same index?</li>
          <li><strong>Solution:</strong> Don't overwrite. Just <code>Add</code> to the list at that index.</li>
          <li><strong>Trade-off:</strong> If the list gets too long, access time degrades from O(1) to O(N).</li>
        </ul>
      </div>

      <div style="margin-top:25px;">
        <div style="font-weight:bold; font-size:12px; color:var(--muted); margin-bottom:5px;">FORCE COLLISION DEMO</div>
        <div style="display:flex; gap:10px;">
           <button class="mini-btn" onclick="addChain('A', 1)" style="flex:1;">Insert 'A' (Idx 1)</button>
           <button class="mini-btn" onclick="addChain('B', 1)" style="flex:1; background:#ef4444; border-color:#ef4444;">Insert 'B' (Idx 1)</button>
        </div>
        <div style="margin-top:10px; font-size:13px; color:var(--muted);">
           Click both to see them link up!
        </div>
      </div>
    </div>

    <div class="card" style="padding:20px; overflow-x:auto;">
      
      <div style="font-weight:bold; color:var(--muted); font-size:12px; margin-bottom:10px;">ARRAY OF LINKED LISTS</div>
      
      <div class="chain-container" id="chain-table">
         <div class="chain-row" id="row-0">
            <div class="bucket-head"><span class="bucket-idx">0</span>/</div>
            <div class="null-ptr">NULL</div>
         </div>
         
         <div class="chain-row" id="row-1">
             <div class="bucket-head"><span class="bucket-idx">1</span>/</div>
             <div class="null-ptr">NULL</div>
         </div>

         <div class="chain-row" id="row-2">
             <div class="bucket-head"><span class="bucket-idx">2</span>/</div>
             <div class="null-ptr">NULL</div>
         </div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing Separate Chaining</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      // Simple structure to track items
      const chains = { 0:[], 1:[], 2:[] };

      window.addChain = function(val, idx) {
        const row = document.getElementById(`row-${idx}`);
        
        // Remove the visual NULL pointer temporarily
        const nullPtr = row.querySelector('.null-ptr');
        if(nullPtr) nullPtr.remove();

        // Create Node
        const node = document.createElement('div');
        node.className = 'chain-node';
        node.innerHTML = `<div class="node-box">${val}</div>`;
        
        // Append
        row.appendChild(node);
        
        // Add NULL back
        const newNull = document.createElement('div');
        newNull.className = 'null-ptr';
        newNull.innerText = 'NULL';
        row.appendChild(newNull);
        
        // Visual Cleanup if duplicate (for simple demo logic)
        // In real Linked List we traverse. Here we just append DOM.
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* List Visualization */
    .search-track {
      display: flex; align-items: center; gap: 10px;
      margin-top: 30px; overflow-x: hidden; padding-bottom: 20px;
    }

    .s-node {
      min-width: 60px; height: 60px;
      border: 2px solid var(--soft); background: white;
      border-radius: 50%;
      display: grid; place-items: center;
      font-weight: bold; font-family: var(--mono);
      position: relative;
      transition: all 0.3s;
    }
    .s-node::after {
      content: "‚ûî"; position: absolute; right: -15px; color: var(--muted); font-size: 14px;
    }
    .s-node:last-child::after { content: ""; }

    /* Search Highlight States */
    .s-node.checking {
      border-color: #f59e0b; background: #fef3c7; transform: scale(1.1);
      box-shadow: 0 0 15px rgba(245, 158, 11, 0.4);
    }
    .s-node.found {
      border-color: #16a34a; background: #dcfce7; color: #166534;
      transform: scale(1.2);
    }

    /* Complexity Badge */
    .comp-badge {
      background: #fee2e2; color: #b91c1c; border: 1px solid #fca5a5;
      padding: 5px 10px; border-radius: 6px; font-weight: bold; font-family: var(--mono);
      display: inline-block; margin-top: 15px;
    }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Performance Analysis</div><div class="sub">The Trap</div></div>
    <span class="pill">Linear Time O(N)</span>
  </div>

  <h2>The Performance Problem</h2>

  <div class="grid-2">
    <div>
      <p>If we just dump everything into a single Linked List, we lose the magic of Hashing.</p>
      
      <div class="card" style="margin-top:20px; border-left: 5px solid #ef4444;">
        <h4 style="margin:0 0 10px 0;">The Lookup Process:</h4>
        <ol style="margin:0; padding-left:20px; line-height:1.6;">
          <li>Start at Head.</li>
          <li>Check Key. Match? Return Value.</li>
          <li>No? Move to Next.</li>
          <li>Repeat until found.</li>
        </ol>
      </div>

      <div style="margin-top:20px;">
        <div style="font-weight:bold; font-size:18px; color:#b91c1c;">
           Result: O(N)
        </div>
        <p style="font-size:14px; color:var(--muted);">
           This defeats the point! We wanted O(1).
        </p>
      </div>
    </div>

    <div class="card" style="padding:20px;">
      
      <div style="display:flex; justify-content:space-between; align-items:center;">
          <div style="font-weight:bold; font-size:12px; color:var(--muted);">LINKED LIST STORAGE</div>
          <button class="mini-btn" onclick="runLinearSearch()">üîç Find Key "Z"</button>
      </div>

      <div class="search-track" id="ll-track">
          <div class="s-node" id="sn-0">A</div>
          <div class="s-node" id="sn-1">B</div>
          <div class="s-node" id="sn-2">C</div>
          <div class="s-node" id="sn-3">D</div>
          <div class="s-node" id="sn-4">E</div>
          <div class="s-node" id="sn-5">Z</div>
      </div>

      <div style="text-align:center; min-height:40px;">
          <div id="search-feedback" style="font-family:var(--mono); font-size:14px; color:var(--muted);">
              Ready to search.
          </div>
          <div id="complexity-warning" class="comp-badge" style="display:none;">
              ‚ö† SLOW: Checked 6 Items
          </div>
      </div>

    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Visualizing Linear Traversal</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const nodes = ['A','B','C','D','E','Z'];
      const feedback = document.getElementById('search-feedback');
      const warning = document.getElementById('complexity-warning');
      let isSearching = false;

      window.runLinearSearch = function() {
        if(isSearching) return;
        isSearching = true;
        warning.style.display = 'none';
        
        // Reset Styles
        nodes.forEach((_, i) => {
            const el = document.getElementById(`sn-${i}`);
            el.className = 's-node';
        });

        let i = 0;
        
        function step() {
            if(i >= nodes.length) return;
            
            const el = document.getElementById(`sn-${i}`);
            const val = nodes[i];
            
            // Highlight Checking
            el.classList.add('checking');
            feedback.innerText = `Checking Key: "${val}"...`;
            
            setTimeout(() => {
                if(val === 'Z') {
                    // Found
                    el.className = 's-node found';
                    feedback.innerText = 'Found "Z"!';
                    feedback.style.color = '#16a34a';
                    warning.innerText = `‚ö† SLOW: Checked ${i+1} Nodes`;
                    warning.style.display = 'inline-block';
                    isSearching = false;
                } else {
                    // Move on
                    el.className = 's-node'; // remove check style
                    i++;
                    step();
                }
            }, 500); // Slow delay to emphasize O(N) slowness
        }
        
        step();
      };
    })();
  </script>

</section>
<section class="slide">
  <style>
    /* Summary Cards (Left Side) */
    .summary-group {
      display: flex; flex-direction: column; gap: 15px; height: 100%; justify-content: center;
    }
    
    .sum-card {
      background: white; border: 1px solid var(--soft);
      border-left: 5px solid var(--muted);
      padding: 15px 20px; border-radius: 8px;
      transition: transform 0.2s;
      cursor: default;
    }
    .sum-card:hover { transform: translateX(10px); }
    
    /* Color coding */
    .sum-stack { border-left-color: #ef4444; }
    .sum-queue { border-left-color: #3b82f6; }
    .sum-hash  { border-left-color: #22c55e; }

    .sum-title { font-weight: 900; font-size: 20px; margin-bottom: 5px; display: flex; justify-content: space-between; }
    .sum-sub { font-family: var(--mono); font-size: 14px; color: var(--muted); text-transform: uppercase; letter-spacing: 1px; }
    .sum-ops { margin-top: 8px; font-size: 15px; color: var(--ink); }

    /* Quiz Container (Right Side) */
    .quiz-box {
      background: #1e293b; color: white;
      border-radius: 12px; padding: 25px;
      height: 100%; display: flex; flex-direction: column;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .quiz-q {
      font-size: 18px; font-weight: bold; line-height: 1.5;
      flex-grow: 1; display: flex; align-items: center; text-align: center; justify-content: center;
    }
    
    .quiz-options {
      display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-top: 20px;
    }
    
    .quiz-btn {
      background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2);
      color: white; padding: 12px; border-radius: 8px; font-weight: bold;
      cursor: pointer; transition: all 0.2s;
    }
    .quiz-btn:hover { background: white; color: #1e293b; }

    /* Feedback animation */
    .quiz-box.correct { animation: pulseGreen 0.5s; background: #14532d; }
    .quiz-box.wrong { animation: shake 0.4s; background: #7f1d1d; }

    @keyframes pulseGreen { 0% { transform: scale(1); } 50% { transform: scale(1.02); } 100% { transform: scale(1); } }
    @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
  </style>

  <div class="slide-top">
    <div class="meta"><div class="course">Wrap Up</div><div class="sub">Key Takeaways</div></div>
    <span class="pill">Summary</span>
  </div>

  <h2>Conclusion</h2>

  <div class="grid-2">
    <div class="summary-group">
      
      <div class="sum-card sum-stack">
        <div class="sum-title">
            Stack <span>üìö</span>
        </div>
        <div class="sum-sub">LIFO (Last-In, First-Out)</div>
        <div class="sum-ops">
            <strong>Operations:</strong> <code>Push()</code>, <code>Pop()</code>
        </div>
      </div>

      <div class="sum-card sum-queue">
        <div class="sum-title">
            Queue <span>üö∂</span>
        </div>
        <div class="sum-sub">FIFO (First-In, First-Out)</div>
        <div class="sum-ops">
            <strong>Operations:</strong> <code>Enqueue()</code>, <code>Dequeue()</code>
        </div>
      </div>

      <div class="sum-card sum-hash">
        <div class="sum-title">
            Hashtable <span>‚ö°</span>
        </div>
        <div class="sum-sub">Key-Value Optimization</div>
        <div class="sum-ops">
            <strong>Goal:</strong> Fast <code>O(1)</code> Lookups
        </div>
      </div>

    </div>

    <div class="quiz-box" id="quiz-container">
       <div style="font-size:12px; text-transform:uppercase; color:#94a3b8; letter-spacing:1px; margin-bottom:10px;">
           Final Review Quiz
       </div>
       
       <div class="quiz-q" id="q-text">
           "I need to implement an Undo button for my text editor."
       </div>

       <div id="q-feedback" style="text-align:center; height:20px; color:#4ade80; font-weight:bold; font-size:14px;"></div>

       <div class="quiz-options">
           <button class="quiz-btn" onclick="checkAnswer('stack')">Stack</button>
           <button class="quiz-btn" onclick="checkAnswer('queue')">Queue</button>
           <button class="quiz-btn" onclick="checkAnswer('hash')">Hashtable</button>
       </div>
    </div>
  </div>
  
  <div class="slide-footer"><div class="muted">Thank you! Any Questions?</div><div class="slide-no" data-slide-no></div></div>

  <script>
    (function(){
      const questions = [
          { text: "Undo button (Ctrl+Z)", ans: "stack" },
          { text: "Printer Spooler (First Come First Serve)", ans: "queue" },
          { text: "Finding a Student by their ID instantly", ans: "hash" },
          { text: "Solving a Maze (Backtracking)", ans: "stack" },
          { text: "Browser History (Back Button)", ans: "stack" },
          { text: "Spotify Playlist (Next Song)", ans: "queue" }
      ];
      
      let qIndex = 0;
      const qText = document.getElementById('q-text');
      const qBox = document.getElementById('quiz-container');
      const feed = document.getElementById('q-feedback');

      window.checkAnswer = function(choice) {
          const current = questions[qIndex];
          
          if(choice === current.ans) {
              // Correct
              qBox.classList.add('correct');
              feed.innerText = "Correct! Next...";
              setTimeout(() => {
                  qBox.classList.remove('correct');
                  nextQuestion();
              }, 600);
          } else {
              // Wrong
              qBox.classList.add('wrong');
              feed.innerText = "Try Again!";
              feed.style.color = "#fca5a5";
              setTimeout(() => {
                  qBox.classList.remove('wrong');
                  feed.innerText = "";
                  feed.style.color = "#4ade80";
              }, 600);
          }
      };

      function nextQuestion() {
          qIndex = (qIndex + 1) % questions.length;
          qText.style.opacity = 0;
          setTimeout(() => {
              qText.innerText = `"${questions[qIndex].text}"`;
              qText.style.opacity = 1;
              feed.innerText = "";
          }, 200);
      }
    })();
  </script>

</section>
</div>
    </div>
  </div>

  <div class="controls" aria-label="Presentation controls">
    <button class="iconbtn" id="prevBtn" onclick="go(-1)" aria-label="Previous slide" title="Previous (‚Üê)">
      <svg viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
    </button>
    <button class="iconbtn" id="nextBtn" onclick="go(1)" aria-label="Next slide" title="Next (‚Üí / Space)">
      <svg viewBox="0 0 24 24"><path d="M9 6l6 6-6 6"/></svg>
    </button>
    <button class="iconbtn" id="fsBtn" onclick="toggleFullScreen()" aria-label="Toggle fullscreen" title="Fullscreen (F)">
      <svg viewBox="0 0 24 24">
        <path d="M8 3H5a2 2 0 0 0-2 2v3"/>
        <path d="M16 3h3a2 2 0 0 1 2 2v3"/>
        <path d="M8 21H5a2 2 0 0 1-2-2v-3"/>
        <path d="M16 21h3a2 2 0 0 0 2-2v-3"/>
      </svg>
    </button>
  </div>

  <script>
    // --- STACK LOGIC ---
    const stackContainer = document.getElementById("stack-visual");
    let stackCounter = 2; // Started with A, B
    const alph = "ABCDEFGHIJ";

    function pushStack() {
        if (stackContainer.children.length >= 5) { alert("Stack Overflow!"); return; }
        const el = document.createElement("div");
        el.className = "data-item stack-item";
        el.innerText = alph[stackCounter % alph.length] || "?";
        el.style.opacity = 1 - (stackContainer.children.length * 0.1);
        stackContainer.appendChild(el);
        stackCounter++;
    }

    function popStack() {
        if (stackContainer.children.length === 0) { alert("Stack Underflow!"); return; }
        const last = stackContainer.lastElementChild;
        last.style.transform = "scale(0.8)"; last.style.opacity = "0";
        setTimeout(() => last.remove(), 200);
        stackCounter--;
    }

    // --- QUEUE LOGIC ---
    const queueContainer = document.getElementById("queue-visual");
    let queueCounter = 3; 

    function enqueue() {
        if (queueContainer.children.length >= 5) { alert("Queue is full for this demo!"); return; }
        queueCounter++;
        const el = document.createElement("div");
        el.className = "data-item queue-item";
        el.innerText = queueCounter;
        queueContainer.appendChild(el);
    }

    function dequeue() {
        if (queueContainer.children.length === 0) { alert("Queue is empty!"); return; }
        const first = queueContainer.firstElementChild;
        first.style.transform = "translateY(30px)"; first.style.opacity = "0";
        setTimeout(() => first.remove(), 200);
    }

    // --- HASH TABLE LOGIC ---
    const hashContainer = document.getElementById("hash-table-visual");
    const tableSize = 5;
    
    // Init Empty Table
    function initHashTable(){
        hashContainer.innerHTML = "";
        for(let i=0; i<tableSize; i++){
            hashContainer.innerHTML += `
                <div class="hash-row">
                    <div class="hash-index">${i}</div>
                    <div class="hash-slot" id="slot-${i}">Empty</div>
                </div>`;
        }
    }
    
    function insertHash(){
        const input = document.getElementById("hashInput");
        const val = parseInt(input.value);
        if(isNaN(val)){ alert("Please enter a valid number"); return; }
        
        const index = val % tableSize;
        const slot = document.getElementById(`slot-${index}`);
        
        // Simple visual collision handling (just overwrite for demo simplicty)
        if(slot.classList.contains("filled")){
            slot.innerText = `${val} (Collision!)`;
            slot.style.backgroundColor = "#fca5a5"; // red tint
            slot.style.color = "#7f1d1d";
        } else {
            slot.classList.add("filled");
            slot.innerText = val;
            slot.style.backgroundColor = ""; 
        }
        input.value = "";
    }

    // --- CORE ENGINE ---
    const slides = Array.from(document.querySelectorAll(".slide"));
    const progressBar = document.getElementById("progress-bar");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    let current = 0;

    function applyScale(){
      const pad = 24;
      const w = window.innerWidth - pad*2;
      const h = window.innerHeight - pad*2;
      const baseW = 1600;
      const baseH = 900;
      const s = Math.min(w/baseW, h/baseH);
      document.documentElement.style.setProperty('--scale', String(Math.max(0.3, Math.min(s, 1.5))));
    }

    function updateSlideNumbers(){
      slides.forEach((s, i) => {
        const holder = s.querySelector("[data-slide-no]");
        if (holder) holder.textContent = `${i + 1} / ${slides.length}`;
      });
    }

    function updateProgress(){
      progressBar.style.width = ((current + 1) / slides.length) * 100 + "%";
    }

    function updateUI(){
      slides.forEach(s => s.classList.remove("active"));
      slides[current].classList.add("active");

      updateProgress();
      prevBtn.disabled = current === 0;
      nextBtn.disabled = current === slides.length - 1;
      
      if(window.MathJax) MathJax.typesetPromise();
    }

    function go(dir){
      const nextIndex = current + dir;
      if(nextIndex < 0 || nextIndex >= slides.length) return;
      current = nextIndex;
      updateUI();
    }

    function toggleFullScreen(){
      if(!document.fullscreenElement){
        document.documentElement.requestFullscreen?.();
      }else{
        document.exitFullscreen?.();
      }
    }
    
    document.addEventListener("keydown", (e) => {
      if(e.key === "ArrowRight" || e.key === " " || e.key === "Enter"){
        if (e.key === " ") e.preventDefault();
        go(1);
      } else if(e.key === "ArrowLeft"){
        go(-1);
      } else if(e.key.toLowerCase() === "f"){
        toggleFullScreen();
      }
    });
    
    // INIT
    window.addEventListener("resize", applyScale);
    initHashTable(); // Init hash visual
    applyScale();
    updateSlideNumbers();
    updateUI();
  </script>
</body>
</html>